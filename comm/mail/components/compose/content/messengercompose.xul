<?xml version="1.0"?>
# This Source Code Form is subject to the terms of the Mozilla Public
# License, v. 2.0. If a copy of the MPL was not distributed with this
# file, You can obtain one at http://mozilla.org/MPL/2.0/.

<?xml-stylesheet href="chrome://messenger/content/bindings.css" type="text/css"?>
<?xml-stylesheet href="chrome://messenger/skin/messengercompose/messengercompose.css" type="text/css"?>
<?xml-stylesheet href="chrome://messenger/skin/folderMenus.css" type="text/css"?>
<?xml-stylesheet href="chrome://messenger/skin/attachmentList.css" type="text/css"?>
<?xml-stylesheet href="chrome://messenger/skin/smime/smime-compose.css" type="text/css"?>
<?xml-stylesheet href="chrome://messenger/skin/menulist.css" type="text/css"?>

<!DOCTYPE window [
  <!ENTITY % messengercomposeDTD SYSTEM "chrome://messenger/locale/messengercompose/messengercompose.dtd" >
  %messengercomposeDTD;
  <!ENTITY % brandDTD SYSTEM "chrome://branding/locale/brand.dtd" >
  %brandDTD;
  <!ENTITY % charsetDTD SYSTEM "chrome://global/locale/charsetMenu.dtd" >
  %charsetDTD;
  <!ENTITY % customizeToolbarDTD SYSTEM "chrome://messenger/locale/customizeToolbar.dtd">
  %customizeToolbarDTD;
  <!ENTITY % textcontextDTD SYSTEM "chrome://global/locale/textcontext.dtd">
  %textcontextDTD;
  <!ENTITY % viewZoomOverlayDTD SYSTEM "chrome://messenger/locale/viewZoomOverlay.dtd">
  %viewZoomOverlayDTD;
  <!ENTITY % baseMenuOverlayDTD SYSTEM "chrome://messenger/locale/baseMenuOverlay.dtd">
  %baseMenuOverlayDTD;
  <!ENTITY % msgCompSMIMEDTD SYSTEM "chrome://messenger-smime/locale/msgCompSMIMEOverlay.dtd">
  %msgCompSMIMEDTD;
  <!ENTITY % editorOverlayDTD SYSTEM "chrome://editor/locale/editorOverlay.dtd">
  %editorOverlayDTD;
  <!ENTITY % utilityOverlayDTD SYSTEM
    "chrome://communicator/locale/utilityOverlay.dtd">
  %utilityOverlayDTD;
]>

<window id="msgcomposeWindow"
        xmlns="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul"
        xmlns:html="http://www.w3.org/1999/xhtml"
        icon="msgcomposeWindow"
        onunload="ComposeUnload()"
        onload="ComposeLoad()"
        onclose="return DoCommandClose()"
        onfocus="EditorOnFocus()"
        title="&msgComposeWindow.title;"
        windowtype="msgcompose"
        macanimationtype="document"
        toggletoolbar="true"
        persist="screenX screenY width height sizemode"
        lightweightthemes="true"
        fullscreenbutton="true">

<stringbundleset id="stringbundleset">
  <stringbundle id="bundle_composeMsgs" src="chrome://messenger/locale/messengercompose/composeMsgs.properties"/>
  <stringbundle id="bundle_messenger"   src="chrome://messenger/locale/messenger.properties"/>
  <stringbundle id="brandBundle"        src="chrome://branding/locale/brand.properties"/>
  <stringbundle id="bundle_comp_smime"  src="chrome://messenger-smime/locale/msgCompSMIMEOverlay.properties"/>
  <stringbundle id="charsetBundle"      src="chrome://communicator/content/labelsencodings.properties"/>
</stringbundleset>

<linkset>
  <html:link rel="localization" href="toolkit/main-window/findbar.ftl"/>
</linkset>

<script src="chrome://global/content/printUtils.js"/>
<script src="chrome://messenger/content/accountUtils.js"/>
<script src="chrome://messenger/content/mailCore.js"/>
<script src="chrome://communicator/content/contentAreaClick.js"/>
<script src="chrome://editor/content/editor.js"/>
<script src="chrome://editor/content/editorUtilities.js"/>
<script src="chrome://editor/content/ComposerCommands.js"/>
<script src="chrome://messenger/content/button-menu-button.js"/>
<script src="chrome://messenger/content/messengercompose/MsgComposeCommands.js"/>
<script src="chrome://messenger/content/messengercompose/bigFileObserver.js"/>
<script src="chrome://messenger/content/messengercompose/cloudAttachmentLinkManager.js"/>

<!-- drag and drop -->
<script src="chrome://messenger/content/addressbook/abDragDrop.js"/>
<script src="chrome://global/content/nsDragAndDrop.js"/>

<!-- move needed functions into a single js file -->
<script src="chrome://messenger/content/messengercompose/addressingWidgetOverlay.js"/>
<script src="chrome://global/content/globalOverlay.js"/>
<script src="chrome://global/content/contentAreaUtils.js"/>
<script src="chrome://messenger/content/viewZoomOverlay.js"/>
#ifdef XP_MACOSX
<script src="chrome://global/content/macWindowMenu.js"/>
#endif
<script src="chrome://communicator/content/utilityOverlay.js"/>
<script src="chrome://messenger/content/toolbarIconColor.js"/>
<script src="chrome://messenger-smime/content/msgCompSMIMEOverlay.js"/>

<commandset id="composeCommands">
  <commandset id="msgComposeCommandUpdate"
              commandupdater="true"
              events="focus"
              oncommandupdate="CommandUpdate_MsgCompose()"/>
  <commandset id="globalEditMenuItems"
              commandupdater="true"
              events="focus"
              oncommandupdate="goUpdateGlobalEditMenuItems()"/>
  <commandset id="selectEditMenuItems"
              commandupdater="true"
              events="select"
              oncommandupdate="goUpdateSelectEditMenuItems()"/>
  <commandset id="undoEditMenuItems"
              commandupdater="true"
              events="undo"
              oncommandupdate="goUpdateUndoEditMenuItems()"/>
  <commandset id="clipboardEditMenuItems"
              commandupdater="true"
              events="clipboard"
              oncommandupdate="goUpdatePasteMenuItems()"/>

  <!-- commands updated when the editor gets created -->
  <commandset id="commonEditorMenuItems"
              commandupdater="true"
              events="create"
              oncommandupdate="goUpdateComposerMenuItems(this)">
    <command id="cmd_printSetup" oncommand="goDoCommand('cmd_printSetup')"/>
    <command id="cmd_print" oncommand="goDoCommand('cmd_print')"/>
    <command id="cmd_quit" oncommand="goDoCommand('cmd_quit')"/>
  </commandset>

  <commandset id="composerMenuItems"
              commandupdater="true"
              events="create, mode_switch"
              oncommandupdate="goUpdateComposerMenuItems(this)">
    <!-- format menu -->
    <command id="cmd_listProperties" oncommand="goDoCommand('cmd_listProperties')"/>
    <command id="cmd_colorProperties" oncommand="goDoCommand('cmd_colorProperties')"/>

    <command id="cmd_link" oncommand="goDoCommand('cmd_link')"/>
    <command id="cmd_anchor" oncommand="goDoCommand('cmd_anchor')"/>
    <command id="cmd_image" oncommand="goDoCommand('cmd_image')"/>
    <command id="cmd_hline" oncommand="goDoCommand('cmd_hline')"/>
    <command id="cmd_table" oncommand="goDoCommand('cmd_table')"/>
    <command id="cmd_form" oncommand="goDoCommand('cmd_form')"/>
    <command id="cmd_inputtag" oncommand="goDoCommand('cmd_inputtag')"/>
    <command id="cmd_inputimage" oncommand="goDoCommand('cmd_inputimage')"/>
    <command id="cmd_textarea" oncommand="goDoCommand('cmd_textarea')"/>
    <command id="cmd_select" oncommand="goDoCommand('cmd_select')"/>
    <command id="cmd_button" oncommand="goDoCommand('cmd_button')"/>
    <command id="cmd_label" oncommand="goDoCommand('cmd_label')"/>
    <command id="cmd_fieldset" oncommand="goDoCommand('cmd_fieldset')"/>
    <command id="cmd_isindex" oncommand="goDoCommand('cmd_isindex')"/>
    <command id="cmd_objectProperties" oncommand="goDoCommand('cmd_objectProperties')"/>
    <command id="cmd_insertChars" oncommand="goDoCommand('cmd_insertChars')" label="&insertCharsCmd.label;"/>
    <command id="cmd_insertHTMLWithDialog" oncommand="goDoCommand('cmd_insertHTMLWithDialog')" label="&insertHTMLCmd.label;"/>
    <command id="cmd_insertMathWithDialog" oncommand="goDoCommand('cmd_insertMathWithDialog')" label="&insertMathCmd.label;"/>

    <command id="cmd_insertBreak" oncommand="goDoCommand('cmd_insertBreak')"/>
    <command id="cmd_insertBreakAll" oncommand="goDoCommand('cmd_insertBreakAll')"/>

    <!-- only used in context popup menu -->
    <command id="cmd_editLink" oncommand="goDoCommand('cmd_editLink')"/>

    <!-- dummy command used just to disable things in non-HTML modes -->
    <command id="cmd_renderedHTMLEnabler"/>
  </commandset>

  <!-- edit menu commands. These get updated by code in globalOverlay.js -->
  <commandset id="composerEditMenuItems"
          commandupdater="true"
          events="create, mode_switch"
          oncommandupdate="goUpdateComposerMenuItems(this)">
    <command id="cmd_pasteNoFormatting" oncommand="goDoCommand('cmd_pasteNoFormatting')"
             label="&pasteNoFormatting.label;" accesskey="&pasteNoFormatting.accesskey;"/>
    <command id="cmd_preferences" oncommand="goDoCommand('cmd_preferences')"/>
    <command id="cmd_findReplace" oncommand="goDoCommand('cmd_findReplace')"/>
    <command id="cmd_find" oncommand="goDoCommand('cmd_find')"/>
    <command id="cmd_findNext" oncommand="goDoCommand('cmd_findNext');"/>
    <command id="cmd_findPrev" oncommand="goDoCommand('cmd_findPrev');"/>
    <command id="cmd_spelling" oncommand="goDoCommand('cmd_spelling')"/>
    <command id="cmd_pasteQuote" oncommand="goDoCommand('cmd_pasteQuote')" label="&pasteAsQuotationCmd.label;"/>
  </commandset>

  <!-- style related commands that update on creation, and on selection change -->
  <commandset id="composerStyleMenuItems"
              commandupdater="true"
              events="create, style, mode_switch"
              oncommandupdate="goUpdateComposerMenuItems(this)">
    <command id="cmd_bold" state="false" oncommand="doStyleUICommand('cmd_bold')"/>
    <command id="cmd_italic" state="false" oncommand="doStyleUICommand('cmd_italic')"/>
    <command id="cmd_underline" state="false" oncommand="doStyleUICommand('cmd_underline')"/>
    <command id="cmd_tt" state="false" oncommand="doStyleUICommand('cmd_tt')"/>
    <command id="cmd_smiley"/>

    <command id="cmd_strikethrough" state="false" oncommand="doStyleUICommand('cmd_strikethrough');"/>
    <command id="cmd_superscript" state="false" oncommand="doStyleUICommand('cmd_superscript');"/>
    <command id="cmd_subscript" state="false" oncommand="doStyleUICommand('cmd_subscript');"/>
    <command id="cmd_nobreak" state="false" oncommand="doStyleUICommand('cmd_nobreak');"/>

    <command id="cmd_em" state="false" oncommand="doStyleUICommand('cmd_em')"/>
    <command id="cmd_strong" state="false" oncommand="doStyleUICommand('cmd_strong')"/>
    <command id="cmd_cite" state="false" oncommand="doStyleUICommand('cmd_cite')"/>
    <command id="cmd_abbr" state="false" oncommand="doStyleUICommand('cmd_abbr')"/>
    <command id="cmd_acronym" state="false" oncommand="doStyleUICommand('cmd_acronym')"/>
    <command id="cmd_code" state="false" oncommand="doStyleUICommand('cmd_code')"/>
    <command id="cmd_samp" state="false" oncommand="doStyleUICommand('cmd_samp')"/>
    <command id="cmd_var" state="false" oncommand="doStyleUICommand('cmd_var')"/>

    <command id="cmd_ul" state="false" oncommand="doStyleUICommand('cmd_ul')"/>
    <command id="cmd_ol" state="false" oncommand="doStyleUICommand('cmd_ol')"/>

    <command id="cmd_indent" oncommand="goDoCommand('cmd_indent')"/>
    <command id="cmd_outdent" oncommand="goDoCommand('cmd_outdent')"/>

    <!-- the state attribute gets filled with the paragraph format before the command is executed -->
    <command id="cmd_paragraphState" state="" oncommand="doStatefulCommand('cmd_paragraphState', event.target.value)"/>
    <command id="cmd_fontFace" state="" oncommand="doStatefulCommand('cmd_fontFace', event.target.value)"/>

    <!-- No "oncommand", use EditorSelectColor() to bring up color dialog -->
    <command id="cmd_fontColor" state="" disabled="false"/>
    <command id="cmd_backgroundColor" state="" disabled="false"/>
    <command id="cmd_highlight" state="transparent" oncommand="EditorSelectColor('Highlight', event);"/>

    <command id="cmd_fontSize" oncommand="goDoCommand('cmd_fontSize')"/>
    <command id="cmd_align" state=""/>

    <command id="cmd_absPos" state="" oncommand="goDoCommand('cmd_absPos')"/>
    <command id="cmd_increaseZIndex" state="" oncommand="goDoCommand('cmd_increaseZIndex')"/>
    <command id="cmd_decreaseZIndex" state="" oncommand="goDoCommand('cmd_decreaseZIndex')"/>

    <command id="cmd_advancedProperties" oncommand="goDoCommand('cmd_advancedProperties')"/>

    <command id="cmd_increaseFontStep" oncommand="goDoCommand('cmd_increaseFontStep')"/>
    <command id="cmd_decreaseFontStep" oncommand="goDoCommand('cmd_decreaseFontStep')"/>

    <command id="cmd_removeStyles" oncommand="goDoCommand('cmd_removeStyles')"/>
    <command id="cmd_removeLinks" oncommand="goDoCommand('cmd_removeLinks')"/>
    <command id="cmd_removeNamedAnchors" oncommand="goDoCommand('cmd_removeNamedAnchors')"/>
  </commandset>

  <commandset id="composerTableMenuItems"
              commandupdater="true"
              events="create, mode_switch"
              oncommandupdate="goUpdateTableMenuItems(this)">
    <!-- Table menu -->
    <command id="cmd_SelectTable" oncommand="goDoCommand('cmd_SelectTable')"/>
    <command id="cmd_SelectRow" oncommand="goDoCommand('cmd_SelectRow')"/>
    <command id="cmd_SelectColumn" oncommand="goDoCommand('cmd_SelectColumn')"/>
    <command id="cmd_SelectCell" oncommand="goDoCommand('cmd_SelectCell')"/>
    <command id="cmd_SelectAllCells" oncommand="goDoCommand('cmd_SelectAllCells')"/>
    <command id="cmd_InsertTable" oncommand="goDoCommand('cmd_InsertTable')"/>
    <command id="cmd_InsertRowAbove" oncommand="goDoCommand('cmd_InsertRowAbove')"/>
    <command id="cmd_InsertRowBelow" oncommand="goDoCommand('cmd_InsertRowBelow')"/>
    <command id="cmd_InsertColumnBefore" oncommand="goDoCommand('cmd_InsertColumnBefore')"/>
    <command id="cmd_InsertColumnAfter" oncommand="goDoCommand('cmd_InsertColumnAfter')"/>
    <command id="cmd_InsertCellBefore" oncommand="goDoCommand('cmd_InsertCellBefore')"/>
    <command id="cmd_InsertCellAfter" oncommand="goDoCommand('cmd_InsertCellAfter')"/>
    <command id="cmd_DeleteTable" oncommand="goDoCommand('cmd_DeleteTable')"/>
    <command id="cmd_DeleteRow" oncommand="goDoCommand('cmd_DeleteRow')"/>
    <command id="cmd_DeleteColumn" oncommand="goDoCommand('cmd_DeleteColumn')"/>
    <command id="cmd_DeleteCell" oncommand="goDoCommand('cmd_DeleteCell')"/>
    <command id="cmd_DeleteCellContents" oncommand="goDoCommand('cmd_DeleteCellContents')"/>
    <command id="cmd_NormalizeTable" oncommand="goDoCommand('cmd_NormalizeTable')"/>
    <command id="cmd_JoinTableCells" oncommand="goDoCommand('cmd_JoinTableCells')"/>
    <command id="cmd_SplitTableCell" oncommand="goDoCommand('cmd_SplitTableCell')"/>
    <command id="cmd_ConvertToTable" oncommand="goDoCommand('cmd_ConvertToTable')"/>
    <command id="cmd_TableOrCellColor" oncommand="goDoCommand('cmd_TableOrCellColor')"/>
    <command id="cmd_editTable" oncommand="goDoCommand('cmd_editTable')"/>
  </commandset>

  <!-- commands updated only when the menu gets created -->
  <commandset id="composerListMenuItems"
              commandupdater="true"
              events="create, mode_switch"
              oncommandupdate="goUpdateComposerMenuItems(this)">
    <!-- List menu  -->
    <command id="cmd_dt" oncommand="doStyleUICommand('cmd_dt')"/>
    <command id="cmd_dd" oncommand="doStyleUICommand('cmd_dd')"/>
    <command id="cmd_removeList" oncommand="goDoCommand('cmd_removeList')"/>
    <!-- cmd_ul and cmd_ol are shared with toolbar and are in composerStyleMenuItems commandset -->
  </commandset>

  <!-- File Menu -->
  <command id="cmd_new" oncommand="goDoCommand('cmd_newMessage')"/>
  <command id="cmd_attachFile" oncommand="goDoCommand('cmd_attachFile')"/>
  <command id="cmd_attachCloud" oncommand="attachToCloud(event)"/>
  <command id="cmd_attachPage" oncommand="goDoCommand('cmd_attachPage')"/>
  <command id="cmd_attachVCard" checked="false"
           oncommand="ToggleAttachVCard(event.target)"/>
  <command id="cmd_remindLater" checked="false"
           oncommand="toggleAttachmentReminder()"/>
  <command id="cmd_close" oncommand="goDoCommand('cmd_close')"/>
  <command id="cmd_saveDefault" oncommand="goDoCommand('cmd_saveDefault')"/>
  <command id="cmd_saveAsFile" oncommand="goDoCommand('cmd_saveAsFile')"/>
  <command id="cmd_saveAsDraft" oncommand="goDoCommand('cmd_saveAsDraft')"/>
  <command id="cmd_saveAsTemplate" oncommand="goDoCommand('cmd_saveAsTemplate')"/>
  <command id="cmd_sendButton" oncommand="goDoCommand('cmd_sendButton')"/>
  <command id="cmd_sendNow" oncommand="goDoCommand('cmd_sendNow')"/>
  <command id="cmd_sendWithCheck" oncommand="goDoCommand('cmd_sendWithCheck')"/>
  <command id="cmd_sendLater" oncommand="goDoCommand('cmd_sendLater')"/>
  <command id="cmd_printSetup" oncommand="goDoCommand('cmd_printSetup')"/>
  <command id="cmd_printPreview" oncommand="goDoCommand('cmd_printPreview')"/>
  <command id="cmd_print" oncommand="goDoCommand('cmd_print')"/>

  <!-- Edit Menu -->
  <!--command id="cmd_pasteQuote"/  DO NOT INCLUDE THOSE COMMANDS ELSE THE EDIT MENU WILL BE BROKEN! -->
  <!--command id="cmd_find"/-->
  <!--command id="cmd_findNext"/-->
  <command id="cmd_undo" oncommand="goDoCommand('cmd_undo')" disabled="true"/>
  <command id="cmd_redo" oncommand="goDoCommand('cmd_redo')" disabled="true"/>
  <command id="cmd_cut" oncommand="goDoCommand('cmd_cut')" disabled="true"/>
  <command id="cmd_copy" oncommand="goDoCommand('cmd_copy')" disabled="true"/>
  <command id="cmd_paste" oncommand="goDoCommand('cmd_paste')" disabled="true"/>
  <command id="cmd_rewrap" oncommand="goDoCommand('cmd_rewrap')"/>
  <command id="cmd_delete"
           oncommand="goDoCommand('cmd_delete')"
           valueDefault="&deleteCmd.label;"
           valueDefaultAccessKey="&deleteCmd.accesskey;"
           valueRemoveAttachmentAccessKey="&removeAttachment.accesskey;"
           disabled="true"/>
  <command id="cmd_selectAll"
           oncommand="goDoCommand('cmd_selectAll')" disabled="true"/>
  <command id="cmd_removeAllAttachments"
           oncommand="goDoCommand('cmd_removeAllAttachments')"/>
  <command id="cmd_openAttachment"
           oncommand="goDoCommand('cmd_openAttachment')" disabled="true"/>
  <command id="cmd_renameAttachment"
           oncommand="goDoCommand('cmd_renameAttachment')" disabled="true"/>
  <command id="cmd_reorderAttachments"
           oncommand="goDoCommand('cmd_reorderAttachments')" disabled="true"/>
  <command id="cmd_toggleAttachmentPane"
           checked="false"
           oncommand="goDoCommand('cmd_toggleAttachmentPane')"/>
  <command id="cmd_account"
           oncommand="goDoCommand('cmd_account')"/>

  <!-- Reorder Attachments Panel -->
  <command id="cmd_moveAttachmentUp"
           oncommand="goDoCommand('cmd_moveAttachmentUp')" disabled="true"/>
  <command id="cmd_moveAttachmentDown"
           oncommand="goDoCommand('cmd_moveAttachmentDown')" disabled="true"/>
  <command id="cmd_moveAttachmentBundleUp"
           oncommand="goDoCommand('cmd_moveAttachmentBundleUp')" disabled="true"/>
  <command id="cmd_moveAttachmentBundleDown"
           oncommand="goDoCommand('cmd_moveAttachmentBundleDown')" disabled="true"/>
  <command id="cmd_moveAttachmentTop"
           oncommand="goDoCommand('cmd_moveAttachmentTop')" disabled="true"/>
  <command id="cmd_moveAttachmentBottom"
           oncommand="goDoCommand('cmd_moveAttachmentBottom')" disabled="true"/>
  <command id="cmd_sortAttachmentsToggle"
           sortdirection="ascending"
           oncommand="goDoCommand('cmd_sortAttachmentsToggle')" disabled="true"/>

  <!-- View Menu -->
  <command id="cmd_showFormatToolbar"
           oncommand="goDoCommand('cmd_showFormatToolbar')"/>

  <commandset id="viewZoomCommands"
              commandupdater="false"
              events="create-menu-view"
              oncommandupdate="goUpdateMailMenuItems(this);">
    <command id="cmd_fullZoomReduce"
             oncommand="goDoCommand('cmd_fullZoomReduce');"/>
    <command id="cmd_fullZoomEnlarge"
             oncommand="goDoCommand('cmd_fullZoomEnlarge');"/>
    <command id="cmd_fullZoomReset"
             oncommand="goDoCommand('cmd_fullZoomReset');"/>
    <command id="cmd_fullZoomToggle"
             oncommand="goDoCommand('cmd_fullZoomToggle');"/>
  </commandset>

  <!-- Options Menu -->
  <command id="cmd_quoteMessage" oncommand="goDoCommand('cmd_quoteMessage')"/>
  <command id="cmd_insert"/>
  <command id="cmd_viewSecurityStatus"
           oncommand="showMessageComposeSecurityStatus();"/>

#ifdef XP_MACOSX
  <!-- Mac Window menu -->
  <command id="minimizeWindow" label="&minimizeWindow.label;" oncommand="window.minimize();"/>
  <command id="zoomWindow" label="&zoomWindow.label;" oncommand="zoomWindow();"/>
  <command id="Tasks:Mail" oncommand="toMessengerWindow();"/>
  <command id="Tasks:AddressBook" oncommand="toAddressBook();"/>
#endif

  <command id="cmd_CustomizeComposeToolbar"
           oncommand="CustomizeMailToolbar('compose-toolbox', 'CustomizeComposeToolbar')"/>

  <command id="cmd_convertCloud" oncommand="convertSelectedToCloudAttachment(event.target.cloudFileAccount); event.stopPropagation();"/>
  <command id="cmd_convertAttachment" oncommand="goDoCommand('cmd_convertAttachment')"/>
  <command id="cmd_cancelUpload" oncommand="goDoCommand('cmd_cancelUpload')"/>
  <command id="cmd_customizeFromAddress" oncommand="MakeFromFieldEditable();"
           checked="false" label="&customizeFromAddress.label;"/>
</commandset>

  <command id="cmd_doNotRemindForAttachments" oncommand="disableAttachmentReminder();"/>

<keyset id="tasksKeys">
  <!-- File Menu -->
#ifdef XP_MACOSX
  <!-- Mac has Command+M as system shortcut to minimize current window, so we offer Command+Shift+M for New Message,
       in addition to cross-platform Command+N. With goOpenNewMessage(), pass null instead of event because
       we don't allow Shift in *keyboard shortcuts* for toggling HTML vs. plaintext format, see bug 672475.
    -->
  <key id="key_newMessage" key="&newMessage.key;" oncommand="goOpenNewMessage(null);" modifiers="accel,shift"/>
  <key id="key_newMessage2" key="&newMessageCmd2.key;" oncommand="goOpenNewMessage(null);" modifiers="accel"/>
#else
  <key id="key_newMessage" key="&newMessage.key;" oncommand="goOpenNewMessage(null);" modifiers="accel"/>
  <key id="key_newMessage2" key="&newMessageCmd2.key;" oncommand="goOpenNewMessage(null);" modifiers="accel"/>
#endif
  <key id="key_attachFile" key="&attachFileCmd.key;" command="cmd_attachFile"
       modifiers="accel,shift"/>
  <key id="key_close" key="&closeCmd.key;" command="cmd_close"  modifiers="accel"/>
  <key id="key_save" key="&saveCmd.key;" command="cmd_saveDefault" modifiers="accel"/>
  <key id="key_send" keycode="&sendCmd.keycode;" observes="cmd_sendWithCheck" modifiers="accel"/>
  <key id="key_sendLater" keycode="&sendLaterCmd.keycode;" observes="cmd_sendLater" modifiers="accel, shift"/>
  <key id="key_print" key="&printCmd.key;" command="cmd_print" modifiers="accel"/>
  <key id="printKb" key="&printCmd.key;" command="cmd_print" modifiers="accel"/>

  <!-- Edit Menu -->
  <key id="key_undo" key="&undoCmd.key;" modifiers="accel"/>
  <key id="key_redo"
#ifdef XP_UNIX
       key="&undoCmd.key;"
       modifiers="accel,shift"/>
#else
       key="&redoCmd.key;"
       modifiers="accel"/>
#endif
  <key id="key_cut" key="&cutCmd.key;" modifiers="accel"/>
  <key id="key_copy" key="&copyCmd.key;" modifiers="accel"/>
  <key id="key_paste" key="&pasteCmd.key;" modifiers="accel"/>
  <key id="pastequotationkb" key="&pasteAsQuotationCmd.key;"
       observes="cmd_pasteQuote" modifiers="accel, shift"/>
  <key id="pastenoformattingkb" key="&pasteNoFormattingCmd.key;"
       modifiers="accel, shift" observes="cmd_pasteNoFormatting"/>
  <key id="key_rewrap" key="&editRewrapCmd.key;" command="cmd_rewrap" modifiers="accel"/>
#ifdef XP_MACOSX
  <key id="key_delete" keycode="VK_BACK" command="cmd_delete"/>
  <key id="key_delete2" keycode="VK_DELETE" command="cmd_delete"/>
  <key id="key_toggleAttachmentPane"
       key="&toggleAttachmentPaneCmd.key;" modifiers="control"
       oncommand="keyToggleAttachmentPaneOnCommand();"/>
#else
  <key id="key_delete" keycode="VK_DELETE" command="cmd_delete"/>
  <key id="key_renameAttachment" keycode="VK_F2"
       command="cmd_renameAttachment"/>
  <key id="key_toggleAttachmentPane"
       key="&attachments.accesskey;" modifiers="alt"
       oncommand="keyToggleAttachmentPaneOnCommand();"/>
#endif
  <key id="key_reorderAttachments"
       key="&reorderAttachmentsCmd.key;" modifiers="accel,shift"
       command="cmd_reorderAttachments"/>
  <key id="key_selectAll" key="&selectAllCmd.key;" modifiers="accel"/>
  <key id="key_find" key="&findBarCmd.key;" command="cmd_find" modifiers="accel"/>
#ifndef XP_MACOSX
  <key id="key_findReplace" key="&findReplaceCmd.key;" command="cmd_findReplace" modifiers="accel"/>
#endif
  <key id="key_findNext" key="&findAgainCmd.key;" command="cmd_findNext" modifiers="accel"/>
  <key id="key_findPrev" key="&findPrevCmd.key;" command="cmd_findPrev" modifiers="accel, shift"/>
  <key keycode="&findAgainCmd.key2;" command="cmd_findNext"/>
  <key keycode="&findPrevCmd.key2;"  command="cmd_findPrev" modifiers="shift"/>

  <!-- Reorder Attachments Panel -->
  <key id="key_moveAttachmentUp" keycode="VK_UP" modifiers="alt"
       command="cmd_moveAttachmentUp"/>
  <key id="key_moveAttachmentDown" keycode="VK_DOWN" modifiers="alt"
       command="cmd_moveAttachmentDown"/>
  <key id="key_moveAttachmentBundleUp" keycode="VK_LEFT" modifiers="alt"
       command="cmd_moveAttachmentBundleUp"/>
  <key id="key_moveAttachmentBundleDown" keycode="VK_RIGHT" modifiers="alt"
       command="cmd_moveAttachmentBundleDown"/>
#ifdef XP_MACOSX
  <key id="key_moveAttachmentTop" keycode="VK_UP" modifiers="accel alt"
       command="cmd_moveAttachmentTop"/>
  <key id="key_moveAttachmentBottom" keycode="VK_DOWN" modifiers="accel alt"
       command="cmd_moveAttachmentBottom"/>
  <key id="key_moveAttachmentTop2" keycode="VK_Home" modifiers="alt"
       command="cmd_moveAttachmentTop"/>
  <key id="key_moveAttachmentBottom2" keycode="VK_End" modifiers="alt"
       command="cmd_moveAttachmentBottom"/>
#else
  <key id="key_moveAttachmentTop" keycode="VK_Home" modifiers="alt"
       command="cmd_moveAttachmentTop"/>
  <key id="key_moveAttachmentBottom" keycode="VK_End" modifiers="alt"
       command="cmd_moveAttachmentBottom"/>
#endif
  <key id="key_sortAttachmentsToggle" key="&sortAttachmentsPanelBtn.key;"
       modifiers="alt" command="cmd_sortAttachmentsToggle"/>

  <!-- View Menu -->
  <key id="key_addressSidebar" keycode="VK_F9" oncommand="toggleAddressPicker();"/>

  <keyset id="viewZoomKeys">
    <key id="key_fullZoomReduce"  key="&fullZoomReduceCmd.commandkey;"
         command="cmd_fullZoomReduce"  modifiers="accel"/>
    <key                          key="&fullZoomReduceCmd.commandkey2;"
         command="cmd_fullZoomReduce"  modifiers="accel"/>
    <key id="key_fullZoomEnlarge" key="&fullZoomEnlargeCmd.commandkey;"
         command="cmd_fullZoomEnlarge" modifiers="accel"/>
    <key                          key="&fullZoomEnlargeCmd.commandkey2;"
         command="cmd_fullZoomEnlarge" modifiers="accel"/>
    <key                          key="&fullZoomEnlargeCmd.commandkey3;"
         command="cmd_fullZoomEnlarge" modifiers="accel"/>
    <key id="key_fullZoomReset"   key="&fullZoomResetCmd.commandkey;"
         command="cmd_fullZoomReset"   modifiers="accel"/>
    <key                          key="&fullZoomResetCmd.commandkey2;"
         command="cmd_fullZoomReset"   modifiers="accel"/>
  </keyset>

  <!-- Options Menu -->
  <key id="key_checkspelling" key="&checkSpellingCmd2.key;" command="cmd_spelling" modifiers="accel,shift"/>

#ifdef XP_WIN
  <key keycode="&checkSpellingCmd2.key2;" command="cmd_spelling"/>
#endif

   <!-- Tools Menu -->
  <key id="key_mail"  key="&messengerCmd.commandkey;" oncommand="toMessengerWindow();" modifiers="accel"/>
  <key id="key_addressbook"
       key="&addressBookCmd.key;"
       modifiers="accel, shift"
       oncommand="toAddressBook();"/>

  <!-- Tab/F6 Keys -->
  <key keycode="VK_TAB" oncommand="SwitchElementFocus(event);" modifiers="control"/>
  <key keycode="VK_TAB" oncommand="SwitchElementFocus(event);" modifiers="control,shift"/>
  <key keycode="VK_F6" oncommand="SwitchElementFocus(event);" modifiers="control"/>
  <key keycode="VK_F6" oncommand="SwitchElementFocus(event);" modifiers="control,shift"/>
  <key keycode="VK_F6" oncommand="SwitchElementFocus(event);" modifiers="shift"/>
  <key keycode="VK_F6" oncommand="SwitchElementFocus(event);"/>

#ifdef XP_MACOSX
  <!-- Mac Window Menu -->
  <key id="key_minimizeWindow" command="minimizeWindow" key="&minimizeWindow.key;" modifiers="accel"/>
  <key id="key_openHelp" oncommand="openSupportURL();" key="&productHelpMac.commandkey;" modifiers="&productHelpMac.modifiers;"/>
#else
  <key id="key_openHelp" oncommand="openSupportURL();" keycode="&productHelp.commandkey;"/>
#endif
  <key keycode="VK_ESCAPE" oncommand="handleEsc();"/>
</keyset>

<keyset id="editorKeys">
  <key id="boldkb" key="&styleBoldCmd.key;" observes="cmd_bold" modifiers="accel"/>
  <key id="italickb" key="&styleItalicCmd.key;" observes="cmd_italic" modifiers="accel"/>
  <key id="underlinekb" key="&styleUnderlineCmd.key;" observes="cmd_underline" modifiers="accel"/>
  <key id="fixedwidthkb" key="&fontFixedWidth.key;" observes="cmd_tt" modifiers="accel"/>

  <key id="increaseindentkb" key="&increaseIndent.key;" observes="cmd_indent" modifiers="accel"/>
  <key id="decreaseindentkb" key="&decreaseIndent.key;" observes="cmd_outdent" modifiers="accel"/>

  <key id="removestyleskb" key="&formatRemoveStyles.key;" observes="cmd_removeStyles" modifiers="accel, shift"/>
  <key id="removestyleskb2" key=" " observes="cmd_removeStyles" modifiers="accel"/>
  <key id="removelinkskb" key="&formatRemoveLinks.key;" observes="cmd_removeLinks" modifiers="accel, shift"/>
  <key id="removenamedanchorskb" key="&formatRemoveNamedAnchors2.key;" observes="cmd_removeNamedAnchors"  modifiers="accel, shift"/>
  <key id="decreasefontsizekb" key="&decrementFontSize.key;" observes="cmd_decreaseFontStep" modifiers="accel"/>
  <key key="&decrementFontSize.key;" observes="cmd_decreaseFontStep" modifiers="accel, shift"/>
  <key key="&decrementFontSize.key2;" observes="cmd_decreaseFontStep" modifiers="accel"/>

  <key id="increasefontsizekb" key="&incrementFontSize.key;" observes="cmd_increaseFontStep" modifiers="accel"/>
  <key key="&incrementFontSize.key;" observes="cmd_increaseFontStep" modifiers="accel, shift"/>
  <key key="&incrementFontSize.key2;" observes="cmd_increaseFontStep" modifiers="accel"/>

  <key id="insertlinkkb" key="&insertLinkCmd2.key;" observes="cmd_link" modifiers="accel"/>
</keyset>

<popupset id="mainPopupSet"/>

<!-- Reorder Attachments Panel -->
<panel id="reorderAttachmentsPanel"
       orient="vertical"
       type="arrow"
       flip="slide"
       onpopupshowing="reorderAttachmentsPanelOnPopupShowing();"
       consumeoutsideclicks="false"
       noautohide="true">
  <description class="panelTitle">&reorderAttachmentsPanel.label;</description>
  <toolbarbutton id="btn_moveAttachmentTop"
                 class="panelButton"
                 label="&moveAttachmentTopPanelBtn.label;"
                 key="key_moveAttachmentTop"
                 command="cmd_moveAttachmentTop"/>
  <toolbarbutton id="btn_moveAttachmentUp"
                 class="panelButton"
                 label="&moveAttachmentUpPanelBtn.label;"
                 key="key_moveAttachmentUp"
                 command="cmd_moveAttachmentUp"/>
  <toolbarbutton id="btn_moveAttachmentBundleUp"
                 class="panelButton"
                 label="&moveAttachmentBundleUpPanelBtn.label;"
                 key="key_moveAttachmentBundleUp"
                 command="cmd_moveAttachmentBundleUp"/>
  <toolbarbutton id="btn_moveAttachmentDown"
                 class="panelButton"
                 label="&moveAttachmentDownPanelBtn.label;"
                 key="key_moveAttachmentDown"
                 command="cmd_moveAttachmentDown"/>
  <toolbarbutton id="btn_moveAttachmentBottom"
                 class="panelButton"
                 label="&moveAttachmentBottomPanelBtn.label;"
                 key="key_moveAttachmentBottom"
                 command="cmd_moveAttachmentBottom"/>
  <toolbarbutton id="btn_sortAttachmentsToggle"
                 class="panelButton"
                 label="&sortAttachmentsPanelBtn.Sort.AZ.label;"
                 label-AZ="&sortAttachmentsPanelBtn.Sort.AZ.label;"
                 label-ZA="&sortAttachmentsPanelBtn.Sort.ZA.label;"
                 label-selection-AZ="&sortAttachmentsPanelBtn.SortSelection.AZ.label;"
                 label-selection-ZA="&sortAttachmentsPanelBtn.SortSelection.ZA.label;"
                 key="key_sortAttachmentsToggle"
                 command="cmd_sortAttachmentsToggle"/>
</panel>

<menupopup id="msgComposeContext"
           onpopupshowing="if (event.target != this) return true; openEditorContextMenu(this);">

  <!-- Spellchecking menu items -->
  <menuitem id="spellCheckNoSuggestions" label="&spellNoSuggestions.label;" disabled="true"/>
  <menuseparator id="spellCheckAddSep" />
  <menuitem id="spellCheckAddToDictionary" label="&spellAddToDictionary.label;" accesskey="&spellAddToDictionary.accesskey;"
            oncommand="gSpellChecker.addToDictionary();"/>
  <menuitem id="spellCheckIgnoreWord" label="&spellCheckIgnoreWord.label;" accesskey="&spellCheckIgnoreWord.accesskey;"
            oncommand="gSpellChecker.ignoreWord();"/>
  <menuseparator id="spellCheckSuggestionsSeparator"/>

  <menuitem label="&undo.label;" accesskey="&undo.accesskey;" command="cmd_undo"/>
  <menuitem label="&cut.label;" accesskey="&cut.accesskey;" command="cmd_cut"/>
  <menuitem label="&copy.label;" accesskey="&copy.accesskey;" command="cmd_copy"/>
  <menuitem label="&paste.label;" accesskey="&paste.accesskey;" command="cmd_paste"/>
  <menuitem command="cmd_pasteNoFormatting"/>
  <menuitem label="&pasteQuote.label;" accesskey="&pasteQuote.accesskey;" command="cmd_pasteQuote"/>
  <menuitem label="&delete.label;" accesskey="&delete.accesskey;" command="cmd_delete"/>
  <menuseparator/>
  <menuitem label="&selectAll.label;" accesskey="&selectAll.accesskey;" command="cmd_selectAll"/>

  <!-- Spellchecking general menu items (enable, add dictionaries...) -->
  <menuseparator id="spellCheckSeparator"/>
  <menuitem id="spellCheckEnable"
            label="&spellCheckToggle.label;"
            type="checkbox"
            accesskey="&spellCheckToggle.accesskey;"
            oncommand="enableInlineSpellCheck(!gSpellChecker.enabled);"/>
  <menuitem id="spellCheckAddDictionariesMain"
            label="&spellAddDictionaries.label;"
            accesskey="&spellAddDictionaries.accesskey;"
            oncommand="openDictionaryList();"/>
  <menu id="spellCheckDictionaries"
        label="&spellDictionaries.label;"
        accesskey="&spellDictionaries.accesskey;">
    <menupopup id="spellCheckDictionariesMenu">
      <menuseparator id="spellCheckLanguageSeparator"/>
      <menuitem id="spellCheckAddDictionaries"
                label="&spellAddDictionaries.label;"
                accesskey="&spellAddDictionaries.accesskey;"
                oncommand="openDictionaryList();"/>
    </menupopup>
  </menu>

</menupopup>

<menupopup id="msgComposeAttachmentItemContext"
           onpopupshowing="updateAttachmentItems();">
  <menuitem id="composeAttachmentContext_openItem"
            label="&openAttachment.label;"
            accesskey="&openAttachment.accesskey;"
            command="cmd_openAttachment"/>
  <menuitem id="composeAttachmentContext_renameItem"
            label="&renameAttachment.label;"
            accesskey="&renameAttachment.accesskey;"
            command="cmd_renameAttachment"/>
  <menuitem id="composeAttachmentContext_reorderItem"
            label="&reorderAttachments.label;"
            accesskey="&reorderAttachments.accesskey;"
            command="cmd_reorderAttachments"/>
  <menuseparator id="composeAttachmentContext_beforeRemoveSeparator"/>
  <menuitem id="composeAttachmentContext_deleteItem"
            label="&removeAttachment.label;"
            accesskey="&removeAttachment.accesskey;"
            command="cmd_delete"/>
  <menu id="composeAttachmentContext_convertCloudMenu"
        label="&convertCloud.label;"
        accesskey="&convertCloud.accesskey;"
        command="cmd_convertCloud">
    <menupopup id="convertCloudMenuItems_popup"
               onpopupshowing="addConvertCloudMenuItems(this, 'convertCloudSeparator', 'context_convertCloud');">
      <menuitem id="convertCloudMenuItems_popup_convertAttachment"
                type="radio" name="context_convertCloud"
                label="&convertRegularAttachment.label;"
                accesskey="&convertRegularAttachment.accesskey;"
                command="cmd_convertAttachment"/>
      <menuseparator id="convertCloudSeparator"/>
    </menupopup>
  </menu>
  <menuitem id="composeAttachmentContext_cancelUploadItem"
            label="&cancelUpload.label;"
            accesskey="&cancelUpload.accesskey;"
            command="cmd_cancelUpload"/>
  <menuseparator/>
  <menuitem id="composeAttachmentContext_selectAllItem"
            label="&selectAll.label;"
            accesskey="&selectAll.accesskey;"
            command="cmd_selectAll"/>
</menupopup>

<menupopup id="msgComposeAttachmentListContext"
           onpopupshowing="updateAttachmentItems();">
  <menuitem id="attachmentListContext_selectAllItem"
            label="&selectAll.label;"
            accesskey="&selectAll.accesskey;"
            command="cmd_selectAll"/>
  <menuseparator/>
  <menuitem id="attachmentListContext_attachFileItem"
            label="&attachFile.label;"
            accesskey="&attachFile.accesskey;"
            command="cmd_attachFile"/>
  <menu id="attachmentListContext_attachCloudMenu"
        label="&attachCloud.label;"
        accesskey="&attachCloud.accesskey;"
        command="cmd_attachCloud">
    <menupopup id="attachCloudMenu_attachCloudPopup" onpopupshowing="if (event.target == this) { addAttachCloudMenuItems(this); }"/>
  </menu>
  <menuitem id="attachmentListContext_attachPageItem"
            label="&attachPage.label;"
            accesskey="&attachPage.accesskey;"
            command="cmd_attachPage"/>
  <menuseparator id="attachmentListContext_remindLaterSeparator"/>
  <menuitem id="attachmentListContext_remindLaterItem"
            type="checkbox"
            label="&remindLater.label;"
            accesskey="&remindLater.accesskey;"
            command="cmd_remindLater"/>
  <menuitem id="attachmentListContext_reorderItem"
            label="&reorderAttachments.label;"
            accesskey="&reorderAttachments.accesskey;"
            command="cmd_reorderAttachments"/>
  <menuseparator id="attachmentListContext_removeAllSeparator"/>
  <menuitem id="attachmentListContext_removeAllItem"
            label="&removeAllAttachments.label;"
            accesskey="&removeAllAttachments.accesskey;"
            command="cmd_removeAllAttachments"/>
</menupopup>

<menupopup id="attachmentHeaderContext"
           onpopupshowing="attachmentHeaderContextOnPopupShowing();">
  <menuitem id="attachmentHeaderContext_initiallyShowItem"
            type="checkbox"
            label="&initiallyShowAttachmentPane.label;"
            accesskey="&initiallyShowAttachmentPane.accesskey;"
            oncommand="toggleInitiallyShowAttachmentPane(this);"/>
</menupopup>

<menupopup id="toolbar-context-menu"
           onpopupshowing="onViewToolbarsPopupShowing(event, 'compose-toolbox');">
  <menuseparator/>
  <menuitem id="CustomizeComposeToolbar"
            command="cmd_CustomizeComposeToolbar"
            label="&customizeToolbar.label;"
            accesskey="&customizeToolbar.accesskey;"/>
</menupopup>

<menupopup id="blockedContentOptions" value=""
           onpopupshowing="onBlockedContentOptionsShowing(event);">
</menupopup>

<menupopup id="languageMenuList"
           oncommand="ChangeLanguage(event);"
           onpopupshowing="OnShowDictionaryMenu(event.target);">
</menupopup>

#ifdef XP_MACOSX
  <vbox id="titlebar">
    <hbox id="titlebar-content">
      <spacer id="titlebar-spacer" flex="1"/>
      <hbox id="titlebar-buttonbox-container" align="start">
        <hbox id="titlebar-buttonbox">
          <toolbarbutton class="titlebar-button" id="titlebar-min" oncommand="window.minimize();"/>
          <toolbarbutton class="titlebar-button" id="titlebar-max" oncommand="onTitlebarMaxClick();"/>
          <toolbarbutton class="titlebar-button" id="titlebar-close" oncommand="window.close()"/>
        </hbox>
      </hbox>
      <hbox id="titlebar-fullscreen-button"/>
    </hbox>
  </vbox>
#endif

  <toolbox id="compose-toolbox"
           class="toolbox-top"
           mode="full"
           defaultmode="full"
#ifdef XP_MACOSX
           iconsize="small"
           defaulticonsize="small"
#endif
           labelalign="end"
           defaultlabelalign="end">

  <!-- Menu -->
  <!-- if you change the id of the menubar, be sure to update mailCore.js::CustomizeMailToolbar and MailToolboxCustomizeDone -->
  <toolbar type="menubar" id="compose-toolbar-menubar2" class="chromeclass-menubar" customizable="true"
#ifdef XP_MACOSX
           defaultset="menubar-items"
#else
          defaultset="menubar-items,spring"
#endif
#ifdef XP_WIN
          toolbarname="&menubarCmd.label;"
          accesskey="&menubarCmd.accesskey;"
#endif
           context="toolbar-context-menu" mode="full">

     <toolbaritem id="menubar-items" align="center">
      <menubar id="mail-menubar">
      <menu id="menu_File" label="&fileMenu.label;" accesskey="&fileMenu.accesskey;">
        <menupopup id="menu_FilePopup">
          <menu id="menu_New" class="menu-iconic"
                label="&newMenu.label;" accesskey="&newMenu.accesskey;">
            <menupopup id="menu_NewPopup">
              <menuitem id="menu_NewMessage" class="menuitem-iconic"
                        label="&newMessage.label;" accesskey="&newMessage.accesskey;"
                        key="key_newMessage2" oncommand="goOpenNewMessage(event);"/>
              <menuseparator/>
              <menuitem id="menu_NewContact" label="&newContact.label;"
                        accesskey="&newContact.accesskey;" class="menuitem-iconic"
                        oncommand="window.openDialog('chrome://messenger/content/addressbook/abNewCardDialog.xul', '', 'chrome,modal,resizable=no,centerscreen');"/>
            </menupopup>
          </menu>
          <menu id="menu_Attach" label="&attachMenu.label;" accesskey="&attachMenu.accesskey;">
            <menupopup id="menu_AttachPopup" onpopupshowing="updateAttachmentItems();">
              <menuitem label="&attachFileCmd.label;" accesskey="&attachFileCmd.accesskey;"
                        key="key_attachFile" command="cmd_attachFile"/>
              <menu label="&attachCloudCmd.label;" accesskey="&attachCloudCmd.accesskey;"
                    command="cmd_attachCloud">
                <menupopup onpopupshowing="if (event.target == this) { addAttachCloudMenuItems(this); }"/>
              </menu>
              <menuitem label="&attachPageCmd.label;"
                        accesskey="&attachPageCmd.accesskey;" command="cmd_attachPage"/>
              <menuseparator/>
              <menuitem type="checkbox"
                        label="&attachVCardCmd.label;" accesskey="&attachVCardCmd.accesskey;"
                        command="cmd_attachVCard"/>
              <menuseparator id="menu_Attach_RemindLaterSeparator"/>
              <menuitem id="menu_Attach_RemindLaterItem" type="checkbox" label="&remindLater.label;"
                        accesskey="&remindLater.accesskey;" command="cmd_remindLater"/>
            </menupopup>
          </menu>
          <menuseparator/>
          <menuitem id="menu_SaveCmd" label="&saveCmd.label;" accesskey="&saveCmd.accesskey;"
                    key="key_save" command="cmd_saveDefault" class="menuitem-iconic"/>
          <menu id="menu_SaveAsCmd" class="menu-iconic menuitem-iconic"
                label="&saveAsCmd.label;" accesskey="&saveAsCmd.accesskey;">
            <menupopup id="menu_SaveAsCmdPopup" onpopupshowing="InitFileSaveAsMenu();">
              <menuitem id="menu_SaveAsFileCmd"
                        label="&saveAsFileCmd.label;" accesskey="&saveAsFileCmd.accesskey;"
                        command="cmd_saveAsFile" type="radio" name="radiogroup_SaveAs"/>
              <menuseparator/>
              <menuitem label="&saveAsDraftCmd.label;" accesskey="&saveAsDraftCmd.accesskey;"
                        command="cmd_saveAsDraft" type="radio" name="radiogroup_SaveAs"/>
              <menuitem label="&saveAsTemplateCmd.label;" accesskey="&saveAsTemplateCmd.accesskey;"
                        command="cmd_saveAsTemplate" type="radio" name="radiogroup_SaveAs"/>
            </menupopup>
          </menu>
          <menuseparator/>
          <menuitem label="&sendNowCmd.label;"
                    accesskey="&sendNowCmd.accesskey;" key="key_send"
                    command="cmd_sendNow" id="menu-item-send-now"/>
          <menuitem label="&sendLaterCmd.label;"
                    accesskey="&sendLaterCmd.accesskey;" key="key_sendLater"
                    command="cmd_sendLater"/>
          <menuseparator/>
          <menuitem id="printSetupMenuItem"
                    label="&printSetupCmd.label;" accesskey="&printSetupCmd.accesskey;"
                    command="cmd_printSetup"/>
#ifndef XP_MACOSX
          <menuitem id="printPreviewMenuItem" class="menuitem-iconic"
                    label="&printPreviewCmd.label;" accesskey="&printPreviewCmd.accesskey;"
                    command="cmd_printPreview"/>
#endif
          <menuitem id="printMenuItem" class="menuitem-iconic"
                    label="&printCmd.label;" accesskey="&printCmd.accesskey;"
                    key="key_print" command="cmd_print"/>
          <menuseparator id="menu_FileCloseSeparator"/>
          <menuitem id="menu_close"
                    class="menuitem-iconic"
                    label="&closeCmd.label;"
                    key="key_close"
                    accesskey="&closeCmd.accesskey;"
                    command="cmd_close"/>
        </menupopup>
      </menu>

      <!-- Edit Menu -->
      <menu id="menu_Edit" label="&editMenu.label;" accesskey="&editMenu.accesskey;">
        <menupopup id="menu_EditPopup" onpopupshowing="updateEditItems();">
          <menuitem id="menu_undo" class="menuitem-iconic"
                    label="&undoCmd.label;" key="key_undo"
                    accesskey="&undoCmd.accesskey;" command="cmd_undo"/>
          <menuitem id="menu_redo" class="menuitem-iconic"
                    label="&redoCmd.label;" key="key_redo"
                    accesskey="&redoCmd.accesskey;" command="cmd_redo"/>
          <menuseparator/>
          <menuitem id="menu_cut" class="menuitem-iconic"
                    label="&cutCmd.label;" key="key_cut"
                    accesskey="&cutCmd.accesskey;" command="cmd_cut"/>
          <menuitem id="menu_copy" class="menuitem-iconic"
                    label="&copyCmd.label;" key="key_copy"
                    accesskey="&copyCmd.accesskey;" command="cmd_copy"/>
          <menuitem id="menu_paste" class="menuitem-iconic"
                    label="&pasteCmd.label;" key="key_paste"
                    accesskey="&pasteCmd.accesskey;" command="cmd_paste"/>
          <menuitem id="menu_pasteNoFormatting"
                    command="cmd_pasteNoFormatting" key="pastenoformattingkb"/>
          <menuitem id="menu_pasteQuote"
                    accesskey="&pasteAsQuotationCmd.accesskey;"
                    command="cmd_pasteQuote"
                    key="pastequotationkb"/>
          <menuitem id="menu_delete" class="menuitem-iconic"
                    label="&deleteCmd.label;"
                    accesskey="&deleteCmd.accesskey;"
                    key="key_delete"
                    command="cmd_delete"/>
          <menuseparator/>
          <menuitem id="menu_rewrap"
                    label="&editRewrapCmd.label;"
                    accesskey="&editRewrapCmd.accesskey;"
                    key="key_rewrap"
                    command="cmd_rewrap"/>
          <menuitem id="menu_RenameAttachment"
                    label="&renameAttachmentCmd.label;"
                    accesskey="&renameAttachmentCmd.accesskey;"
                    key="key_renameAttachment"
                    command="cmd_renameAttachment"/>
          <menuitem id="menu_reorderAttachments"
                    label="&reorderAttachmentsCmd.label;"
                    accesskey="&reorderAttachmentsCmd.accesskey;"
                    key="key_reorderAttachments"
                    command="cmd_reorderAttachments"/>
          <menuseparator/>
          <menuitem id="menu_selectAll"
                    label="&selectAllCmd.label;"
                    accesskey="&selectAllCmd.accesskey;"
                    key="key_selectAll"
                    command="cmd_selectAll"/>
          <menuseparator/>
          <menuitem id="menu_findBar"
                    label="&findBarCmd.label;"
                    accesskey="&findBarCmd.accesskey;"
                    key="key_find"
                    command="cmd_find"/>
#ifndef XP_MACOSX
          <menuitem id="menu_findReplace"
                    label="&findReplaceCmd.label;"
                    accesskey="&findReplaceCmd.accesskey;"
                    key="key_findReplace"
                    command="cmd_findReplace"/>
#else
          <menuitem id="menu_findReplace"
                    label="&findReplaceCmd.label;"
                    accesskey="&findReplaceCmd.accesskey;"
                    command="cmd_findReplace"/>
#endif
          <menuitem id="menu_findNext"
                    label="&findAgainCmd.label;"
                    accesskey="&findAgainCmd.accesskey;"
                    key="key_findNext"
                    command="cmd_findNext"/>
          <menuitem id="menu_findPrev"
                    label="&findPrevCmd.label;"
                    accesskey="&findPrevCmd.accesskey;"
                    key="key_findPrev"
                    command="cmd_findPrev"/>
#ifdef XP_UNIX
#ifndef XP_MACOSX
          <menuseparator id="prefSep"/>
          <menuitem id="menu_accountmgr"
                    label="&accountManagerCmd2.label;"
                    accesskey="&accountManagerCmdUnix2.accesskey;"
                    command="cmd_account"/>
          <menuitem id="menu_preferences" label="&preferencesCmdUnix.label;"
                    accesskey="&preferencesCmdUnix.accesskey;"
                    oncommand="openOptionsDialog('paneCompose');"
                    class="menuitem-iconic"/>
#endif
#endif
        </menupopup>
      </menu>

      <!-- View Menu -->
      <menu id="menu_View" label="&viewMenu.label;" accesskey="&viewMenu.accesskey;">
        <menupopup id="menu_View_Popup" onpopupshowing="updateViewItems();">
          <menu id="menu_ToolbarsNew"
                label="&viewToolbarsMenuNew.label;"
                accesskey="&viewToolbarsMenuNew.accesskey;"
                onpopupshowing="onViewToolbarsPopupShowing(event, 'compose-toolbox');">
            <menupopup id="view_toolbars_popup">
              <menuitem id="menu_showFormatToolbar"
                        type="checkbox"
                        label="&showFormattingBarCmd.label;"
                        accesskey="&showFormattingBarCmd.accesskey;"
                        command="cmd_showFormatToolbar"
                        checked="true"/>
              <menuitem id="menu_showTaskbar"
                        type="checkbox"
                        label="&showTaskbarCmd.label;"
                        accesskey="&showTaskbarCmd.accesskey;"
                        oncommand="goToggleToolbar('status-bar', 'menu_showTaskbar')"
                        checked="true"/>
              <menuseparator id="viewMenuBeforeCustomizeComposeToolbarsSeparator"/>
              <menuitem id="customizeComposeToolbars"
                        label="&customizeToolbar.label;"
                        accesskey="&customizeToolbar.accesskey;"
                        command="cmd_CustomizeComposeToolbar"/>
            </menupopup>
          </menu>
          <menu id="viewFullZoomMenu" label="&fullZoom.label;" accesskey="&fullZoom.accesskey;"
                onpopupshowing="UpdateFullZoomMenu()">
            <menupopup id="viewFullZoomPopupMenu">
              <menuitem id="menu_fullZoomEnlarge" key="key_fullZoomEnlarge"
                        label="&fullZoomEnlargeCmd.label;"
                        accesskey="&fullZoomEnlargeCmd.accesskey;"
                        command="cmd_fullZoomEnlarge"
                        class="menuitem-iconic"/>
              <menuitem id="menu_fullZoomReduce" key="key_fullZoomReduce"
                        label="&fullZoomReduceCmd.label;"
                        accesskey="&fullZoomReduceCmd.accesskey;"
                        command="cmd_fullZoomReduce"
                        class="menuitem-iconic"/>
              <menuseparator id="fullZoomAfterReduceSeparator"/>
              <menuitem id="menu_fullZoomReset" key="key_fullZoomReset"
                        label="&fullZoomResetCmd.label;"
                        accesskey="&fullZoomResetCmd.accesskey;"
                        command="cmd_fullZoomReset"
                        class="menuitem-iconic"/>
              <menuseparator id="fullZoomAfterResetSeparator"/>
              <menuitem id="menu_fullZoomToggle" label="&fullZoomToggleCmd.label;"
                        accesskey="&fullZoomToggleCmd.accesskey;"
                        type="checkbox" command="cmd_fullZoomToggle" checked="false"/>
            </menupopup>
          </menu>
          <menuitem id="menu_AddressSidebar"
                    label="&addressSidebar.label;" accesskey="&addressSidebar.accesskey;"
                    type="checkbox"
                    autoCheck="false"
                    key="key_addressSidebar"
                    oncommand="toggleAddressPicker();"/>
          <menuitem id="menu_toggleAttachmentPane"
                    label="&toggleAttachmentPaneCmd.label;"
                    accesskey="&toggleAttachmentPaneCmd.accesskey;"
                    type="checkbox"
                    key="key_toggleAttachmentPane"
                    command="cmd_toggleAttachmentPane"/>
          <menuseparator id="viewMenuBeforeSecurityStatusSeparator"/>
          <menuitem id="menu_viewSecurityStatus"
                    label="&menu_viewSecurityStatus.label;"
                    accesskey="&menu_viewSecurityStatus.accesskey;"
                    command="cmd_viewSecurityStatus"
                    class="menuitem-iconic"/>
        </menupopup>
      </menu>

      <menu id="insertMenu" label="&insertMenu.label;"
            accesskey="&insertMenu.accesskey;" command="cmd_renderedHTMLEnabler">
        <menupopup id="insertMenuPopup">
          <menuitem id="insertImage"
                    label="&insertImageCmd.label;"
                    accesskey="&insertImageCmd.accesskey;"
                    observes="cmd_image"/>
          <menuitem id="insertTable"
                    label="&insertTableCmd.label;"
                    accesskey="&insertTableCmd.accesskey;"
                    observes="cmd_InsertTable"/>
          <menuitem id="insertLink"
                    label="&insertLinkCmd2.label;"
                    accesskey="&insertLinkCmd2.accesskey;"
                    key="insertlinkkb"
                    observes="cmd_link"/>
          <menuitem id="insertAnchor"
                    label="&insertAnchorCmd.label;"
                    accesskey="&insertAnchorCmd.accesskey;"
                    observes="cmd_anchor"/>
          <menuitem id="insertHline"
                    label="&insertHLineCmd.label;"
                    accesskey="&insertHLineCmd.accesskey;"
                    observes="cmd_hline"/>
          <menuitem id="insertHTMLSource"
                    accesskey="&insertHTMLCmd.accesskey;"
                    observes="cmd_insertHTMLWithDialog"/>
          <menuitem id="insertMath"
                    accesskey="&insertMathCmd.accesskey;"
                    observes="cmd_insertMathWithDialog"/>
          <menuitem id="insertChars"
                    accesskey="&insertCharsCmd.accesskey;"
                    command="cmd_insertChars"/>

          <menu id="insertTOC" label="&tocMenu.label;" accesskey="&tocMenu.accesskey;">
            <menupopup id="insertTOCPopup" onpopupshowing="InitTOCMenu()">
              <menuitem id="insertTOCMenuitem"
                        label="&insertTOC.label;"
                        accesskey="&insertTOC.accesskey;"
                        oncommand="UpdateTOC()"/>
              <menuitem id="updateTOCMenuitem"
                        label="&updateTOC.label;"
                        accesskey="&updateTOC.accesskey;"
                        oncommand="UpdateTOC()"/>
              <menuitem id="removeTOCMenuitem"
                        label="&removeTOC.label;"
                        accesskey="&removeTOC.accesskey;"
                        oncommand="RemoveTOC()"/>
            </menupopup>
          </menu>
          <menuseparator id="insertMenuSeparator"/>
          <menuitem id="insertBreakAll"
                    accesskey="&insertBreakAllCmd.accesskey;"
                    observes="cmd_insertBreakAll"
                    label="&insertBreakAllCmd.label;"/>
        </menupopup>
      </menu>

      <menu id="formatMenu" label="&formatMenu.label;" accesskey="&formatMenu.accesskey;" command="cmd_renderedHTMLEnabler">
        <menupopup id="formatMenuPopup" onpopupshowing="EditorInitFormatMenu()">
          <!-- Font face submenu -->
          <menu id="fontFaceMenu" class="menu-iconic"
                label="&fontfaceMenu.label;" accesskey="&fontfaceMenu.accesskey;"
                position="1">
            <menupopup id="fontFaceMenuPopup"
                       oncommand="if (event.target.localName == 'menuitem')
                                    doStatefulCommand('cmd_fontFace', event.target.getAttribute('value'));"
                       onpopupshowing="initFontFaceMenu(this);">
              <menuitem id="menu_fontFaceVarWidth"
                        label="&fontVarWidth.label;"
                        accesskey="&fontVarWidth.accesskey;"
                        value=""
                        type="radio"
                        observes="cmd_renderedHTMLEnabler"/>
              <menuitem id="menu_fontFaceFixedWidth"
                        label="&fontFixedWidth.label;"
                        accesskey="&fontFixedWidth.accesskey;"
                        value="tt"
                        type="radio"
                        observes="cmd_renderedHTMLEnabler"/>
              <menuseparator id="fontFaceMenuAfterGenericFontsSeparator"/>
              <menuitem id="menu_fontFaceHelvetica"
                        label="&fontHelvetica.label;"
                        accesskey="&fontHelvetica.accesskey;"
                        value="Helvetica, Arial, sans-serif"
                        value_parsed="helvetica,arial,sans-serif"
                        type="radio"
                        observes="cmd_renderedHTMLEnabler"/>
              <menuitem id="menu_fontFaceTimes"
                        label="&fontTimes.label;"
                        accesskey="&fontTimes.accesskey;"
                        value="Times New Roman, Times, serif"
                        value_parsed="times new roman,times,serif"
                        type="radio"
                        observes="cmd_renderedHTMLEnabler"/>
              <menuitem id="menu_fontFaceCourier"
                        label="&fontCourier.label;"
                        accesskey="&fontCourier.accesskey;"
                        value="Courier New, Courier, monospace"
                        value_parsed="courier new,courier,monospace"
                        type="radio"
                        observes="cmd_renderedHTMLEnabler"/>
              <menuseparator id="fontFaceMenuAfterDefaultFontsSeparator"
                             class="fontFaceMenuAfterDefaultFonts"/>
              <menuseparator id="fontFaceMenuAfterUsedFontsSeparator"
                             class="fontFaceMenuAfterUsedFonts"
                             hidden="true"/>
                <!-- Local font face items added here by initLocalFontFaceMenu() -->
            </menupopup>
          </menu>

          <!-- Font size submenu -->
          <menu id="fontSizeMenu" label="&fontSizeMenu.label;"
                accesskey="&fontSizeMenu.accesskey;"
                position="2">
            <menupopup id="fontSizeMenuPopup" onpopupshowing="initFontSizeMenu(this, true)">
              <menuitem id="menu_decreaseFontSize"
                        label="&decreaseFontSize.label;"
                        accesskey="&decreaseFontSize.accesskey;"
                        key="decreasefontsizekb"
                        observes="cmd_decreaseFontStep"
                        type="radio" name="1" autocheck="false"/>
              <menuitem id="menu_increaseFontSize"
                        label="&increaseFontSize.label;"
                        accesskey="&increaseFontSize.accesskey;"
                        key="increasefontsizekb"
                        observes="cmd_increaseFontStep"
                        type="radio" name="1" autocheck="false"/>
              <menuseparator id="fontSizeMenuAfterIncreaseFontSizeSeparator"/>
              <menuitem id="menu_size-x-small"
                        label="&size-tinyCmd.label;"
                        accesskey="&size-tinyCmd.accesskey;"
                        oncommand="EditorSetFontSize('x-small')"
                        type="radio" name="1"
                        observes="cmd_renderedHTMLEnabler"/>
              <menuitem id="menu_size-small"
                        label="&size-smallCmd.label;"
                        accesskey="&size-smallCmd.accesskey;"
                        oncommand="EditorSetFontSize('small')"
                        type="radio" name="1"
                        observes="cmd_renderedHTMLEnabler"/>
              <menuitem id="menu_size-medium"
                        label="&size-mediumCmd.label;"
                        accesskey="&size-mediumCmd.accesskey;"
                        oncommand="EditorSetFontSize('medium')"
                        type="radio" name="1"
                        observes="cmd_renderedHTMLEnabler"/>
              <menuitem id="menu_size-large"
                        label="&size-largeCmd.label;"
                        accesskey="&size-largeCmd.accesskey;"
                        oncommand="EditorSetFontSize('large')"
                        type="radio" name="1"
                        observes="cmd_renderedHTMLEnabler"/>
              <menuitem id="menu_size-x-large"
                        label="&size-extraLargeCmd.label;"
                        accesskey="&size-extraLargeCmd.accesskey;"
                        oncommand="EditorSetFontSize('x-large')"
                        type="radio" name="1"
                        observes="cmd_renderedHTMLEnabler"/>
              <menuitem id="menu_size-xx-large"
                        label="&size-hugeCmd.label;"
                        accesskey="&size-hugeCmd.accesskey;"
                        oncommand="EditorSetFontSize('xx-large')"
                        type="radio" name="1"
                        observes="cmd_renderedHTMLEnabler"/>
              <menuitem id="fontSizeMenu_smallBigInfo"
                        type="checkbox" name="2" disabled="true" hidden="true"/>
            </menupopup>
          </menu>

          <!-- Font style submenu -->
          <menu id="fontStyleMenu" label="&fontStyleMenu.label;"
                accesskey="&fontStyleMenu.accesskey;"
                position="3">
          <menupopup id="fontStyleMenuPopup" onpopupshowing="initFontStyleMenu(this)">
            <menuitem id="menu_styleBold"
                      label="&styleBoldCmd.label;"
                      accesskey="&styleBoldCmd.accesskey;"
                      observes="cmd_bold"
                      type="checkbox"
                      key="boldkb"/>
            <menuitem id="menu_styleItalic"
                      label="&styleItalicCmd.label;"
                      accesskey="&styleItalicCmd.accesskey;"
                      observes="cmd_italic"
                      type="checkbox"
                      key="italickb"/>
            <menuitem id="menu_styleUnderline"
                      label="&styleUnderlineCmd.label;"
                      accesskey="&styleUnderlineCmd.accesskey;"
                      observes="cmd_underline"
                      type="checkbox"
                      key="underlinekb"/>
            <menuitem id="menu_styleStrikeThru"
                      label="&styleStrikeThruCmd.label;"
                      accesskey="&styleStrikeThruCmd.accesskey;"
                      observes="cmd_strikethrough"
                      type="checkbox"/>
            <menuitem id="menu_styleSuperscript"
                      label="&styleSuperscriptCmd.label;"
                      accesskey="&styleSuperscriptCmd.accesskey;"
                      observes="cmd_superscript"
                      type="checkbox"/>
            <menuitem id="menu_styleSubscript"
                      label="&styleSubscriptCmd.label;"
                      accesskey="&styleSubscriptCmd.accesskey;"
                      observes="cmd_subscript"
                      type="checkbox"/>
            <menuitem id="menu_fontFixedWidth"
                      label="&fontFixedWidth.label;"
                      accesskey="&fontFixedWidth.accesskey;"
                      observes="cmd_tt"
                      type="checkbox"
                      key="fixedwidthkb"/>
            <menuitem id="menu_styleNonbreaking"
                      label="&styleNonbreakingCmd.label;"
                      accesskey="&styleNonbreakingCmd.accesskey;"
                      observes="cmd_nobreak"
                      type="checkbox"/>
            <menuseparator id="fontStyleMenuAfterNonbreakingSeparator"/>
            <menuitem id="menu_styleEm"
                      label="&styleEm.label;"
                      accesskey="&styleEm.accesskey;"
                      observes="cmd_em"
                      type="checkbox"/>
            <menuitem id="menu_styleStrong"
                      label="&styleStrong.label;"
                      accesskey="&styleStrong.accesskey;"
                      observes="cmd_strong"
                      type="checkbox"/>
            <menuitem id="menu_styleCite"
                      label="&styleCite.label;"
                      accesskey="&styleCite.accesskey;"
                      observes="cmd_cite"
                      type="checkbox"/>
            <menuitem id="menu_styleAbbr"
                      label="&styleAbbr.label;"
                      accesskey="&styleAbbr.accesskey;"
                      observes="cmd_abbr"
                      type="checkbox"/>
            <menuitem id="menu_styleAcronym"
                      label="&styleAcronym.label;"
                      accesskey="&styleAcronym.accesskey;"
                      observes="cmd_acronym"
                      type="checkbox"/>
            <menuitem id="menu_styleCode"
                      label="&styleCode.label;"
                      accesskey="&styleCode.accesskey;"
                      observes="cmd_code"
                      type="checkbox"/>
            <menuitem id="menu_styleSamp"
                      label="&styleSamp.label;"
                      accesskey="&styleSamp.accesskey;"
                      observes="cmd_samp"
                      type="checkbox"/>
            <menuitem id="menu_styleVar"
                      label="&styleVar.label;"
                      accesskey="&styleVar.accesskey;"
                      observes="cmd_var"
                      type="checkbox"/>
          </menupopup>
          </menu>

          <!-- Note: "cmd_fontColor" only monitors color state, it doesn't execute the command
               (We should use "cmd_fontColorState" and "cmd_backgroundColorState" ?) -->
          <menuitem id="fontColor" label="&formatFontColor.label;"
                    accesskey="&formatFontColor.accesskey;"
                    observes="cmd_fontColor"
                    oncommand="EditorSelectColor('Text', null);"
                    position="4"
                    class="menuitem-iconic"/>
          <menuseparator id="removeSep" position="5"/>

          <!-- label and accesskey set at runtime from strings -->
          <menuitem id="removeStylesMenuitem" key="removestyleskb"
                    observes="cmd_removeStyles"
                    position="6"/>
          <menuitem id="removeLinksMenuitem" key="removelinkskb"
                    observes="cmd_removeLinks"
                    position="7"/>
          <menuitem id="removeNamedAnchorsMenuitem"  label="&formatRemoveNamedAnchors.label;"
                    key="removenamedanchorskb"
                    accesskey="&formatRemoveNamedAnchors.accesskey;"
                    observes="cmd_removeNamedAnchors"
                    position="8"/>
          <menuseparator id="tabSep" position="9"/>

          <!-- Note: the 'Init' menu methods for Paragraph, List, and Align
               assume that the id = 'menu_'+tagName (the 'value' label),
               except for the first ('none') item
           -->
          <!-- Paragraph Style submenu -->
          <menu id="paragraphMenu" label="&paragraphMenu.label;"
                accesskey="&paragraphMenu.accesskey;"
                position="10" onpopupshowing="InitParagraphMenu()">
            <menupopup id="paragraphMenuPopup"
                       oncommand="doStatefulCommand('cmd_paragraphState', event.target.getAttribute('value'))">
              <menuitem id="menu_bodyText"
                        type="radio"
                        name="1"
                        label="&bodyTextCmd.label;"
                        accesskey="&bodyTextCmd.accesskey;"
                        value=""
                        observes="cmd_renderedHTMLEnabler"/>
              <menuitem id="menu_p"
                        type="radio"
                        name="1"
                        label="&paragraphParagraphCmd.label;"
                        accesskey="&paragraphParagraphCmd.accesskey;"
                        value="p"
                        observes="cmd_renderedHTMLEnabler"/>
              <menuitem id="menu_h1"
                        type="radio"
                        name="1"
                        label="&heading1Cmd.label;"
                        accesskey="&heading1Cmd.accesskey;"
                        value="h1"
                        observes="cmd_renderedHTMLEnabler"/>
              <menuitem id="menu_h2"
                        type="radio"
                        name="1"
                        label="&heading2Cmd.label;"
                        accesskey="&heading2Cmd.accesskey;"
                        value="h2"
                        observes="cmd_renderedHTMLEnabler"/>
              <menuitem id="menu_h3"
                        type="radio"
                        name="1"
                        label="&heading3Cmd.label;"
                        accesskey="&heading3Cmd.accesskey;"
                        value="h3"
                        observes="cmd_renderedHTMLEnabler"/>
              <menuitem id="menu_h4"
                        type="radio"
                        name="1"
                        label="&heading4Cmd.label;"
                        accesskey="&heading4Cmd.accesskey;"
                        value="h4"
                        observes="cmd_renderedHTMLEnabler"/>
              <menuitem id="menu_h5"
                        type="radio"
                        name="1"
                        label="&heading5Cmd.label;"
                        accesskey="&heading5Cmd.accesskey;"
                        value="h5"
                        observes="cmd_renderedHTMLEnabler"/>
              <menuitem id="menu_h6"
                        type="radio"
                        name="1"
                        label="&heading6Cmd.label;"
                        accesskey="&heading6Cmd.accesskey;"
                        value="h6"
                        observes="cmd_renderedHTMLEnabler"/>
              <menuitem id="menu_address"
                        type="radio"
                        name="1"
                        label="&paragraphAddressCmd.label;"
                        accesskey="&paragraphAddressCmd.accesskey;"
                        value="address"
                        observes="cmd_renderedHTMLEnabler"/>
              <menuitem id="menu_pre"
                        type="radio"
                        name="1"
                        label="&paragraphPreformatCmd.label;"
                        accesskey="&paragraphPreformatCmd.accesskey;"
                        value="pre"
                        observes="cmd_renderedHTMLEnabler"/>
            </menupopup>
          </menu>

          <!-- List Style submenu -->
          <menu id="listMenu" label="&formatlistMenu.label;"
                accesskey="&formatlistMenu.accesskey;"
                position="11" onpopupshowing="InitListMenu()">
            <menupopup id="listMenuPopup">
              <menuitem id="menu_noList"
                        type="radio"
                        name="1"
                        label="&noneCmd.label;"
                        accesskey="&noneCmd.accesskey;"
                        observes="cmd_removeList"/>
              <menuitem id="menu_ul"
                        type="radio"
                        name="1"
                        label="&listBulletCmd.label;"
                        accesskey="&listBulletCmd.accesskey;"
                        observes="cmd_ul"/>
              <menuitem id="menu_ol"
                        type="radio"
                        name="1"
                        label="&listNumberedCmd.label;"
                        accesskey="&listNumberedCmd.accesskey;"
                        observes="cmd_ol"/>
              <menuitem id="menu_dt"
                        type="radio"
                        name="1"
                        label="&listTermCmd.label;"
                        accesskey="&listTermCmd.accesskey;"
                        observes="cmd_dt"/>
              <menuitem id="menu_dd"
                        type="radio"
                        name="1"
                        label="&listDefinitionCmd.label;"
                        accesskey="&listDefinitionCmd.accesskey;"
                        observes="cmd_dd"/>
              <menuseparator/>
              <menuitem id="listProps"
                        label="&listPropsCmd.label;"
                        accesskey="&listPropsCmd.accesskey;"
                        observes="cmd_listProperties"/>
            </menupopup>
          </menu>
          <menuseparator id="identingSep" position="12"/>

          <menuitem id="increaseIndent"
                    label="&increaseIndent.label;"
                    accesskey="&increaseIndent.accesskey;"
                    key="increaseindentkb"
                    observes="cmd_indent"
                    position="13"
                    class="menuitem-iconic"/>
          <menuitem id="decreaseIndent"
                    label="&decreaseIndent.label;"
                    accesskey="&decreaseIndent.accesskey;"
                    key="decreaseindentkb"
                    observes="cmd_outdent"
                    position="14"
                    class="menuitem-iconic"/>

          <menu id="alignMenu" label="&alignMenu.label;" accesskey="&alignMenu.accesskey;"
              onpopupshowing="InitAlignMenu()"
              position="15">
            <!-- Align submenu -->
            <menupopup id="alignMenuPopup"
                       oncommand="doStatefulCommand('cmd_align', event.target.getAttribute('value'))">
              <menuitem id="menu_left"
                        label="&alignLeft.label;"
                        accesskey="&alignLeft.accesskey;"
                        type="radio"
                        name="1"
                        value="left"
                        observes="cmd_renderedHTMLEnabler"/>
              <menuitem id="menu_center"
                        label="&alignCenter.label;"
                        accesskey="&alignCenter.accesskey;"
                        type="radio"
                        name="1"
                        value="center"
                        observes="cmd_renderedHTMLEnabler"/>
              <menuitem id="menu_right"
                        label="&alignRight.label;"
                        accesskey="&alignRight.accesskey;"
                        type="radio"
                        name="1"
                        value="right"
                        observes="cmd_renderedHTMLEnabler"/>
              <menuitem id="menu_justify"
                        label="&alignJustify.label;"
                        accesskey="&alignJustify.accesskey;"
                        type="radio"
                        name="1"
                        value="justify"
                        observes="cmd_renderedHTMLEnabler"/>
            </menupopup>
          </menu>
          <menuseparator id="tableSep" position="16"/>
          <menu id="tableMenu" label="&tableMenu.label;" accesskey="&tableMenu.accesskey;">
            <menupopup id="tableMenuPopup" onpopupshowing="EditorInitTableMenu()">
              <menu id="tableInsertMenu" label="&tableInsertMenu.label;" accesskey="&tableInsertMenu.accesskey;">
                <menupopup id="tableMenuPopup">
                  <menuitem id="menu_insertTable"
                            label="&insertTableCmd.label;"
                            accesskey="&insertTableCmd.accesskey;"
                            observes="cmd_InsertTable"/>
                  <menuseparator id="tableMenuAfterInsertTableSeparator"/>
                  <menuitem id="menu_tableRowAbove"
                            label="&tableRowAbove.label;"
                            accesskey="&tableRowAbove.accesskey;"
                            observes="cmd_InsertRowAbove"/>
                  <menuitem id="menu_tableRowBelow"
                            label="&tableRowBelow.label;"
                            accesskey="&tableRowBelow.accesskey;"
                            observes="cmd_InsertRowBelow"/>
                  <menuseparator id="tableMenuAfterTableRowSeparator"/>
                  <menuitem id="menu_tableColumnBefore"
                            label="&tableColumnBefore.label;"
                            accesskey="&tableColumnBefore.accesskey;"
                            observes="cmd_InsertColumnBefore"/>
                  <menuitem id="menu_tableColumnAfter"
                            label="&tableColumnAfter.label;"
                            accesskey="&tableColumnAfter.accesskey;"
                            observes="cmd_InsertColumnAfter"/>
                  <menuseparator id="tableMenuAfterInsertColumnSeparator"/>
                  <menuitem id="menu_tableCellBefore"
                            label="&tableCellBefore.label;"
                            accesskey="&tableCellBefore.accesskey;"
                            observes="cmd_InsertCellBefore"/>
                  <menuitem id="menu_tableCellAfter"
                            label="&tableCellAfter.label;"
                            accesskey="&tableCellAfter.accesskey;"
                            observes="cmd_InsertCellAfter"/>
                </menupopup>
              </menu>
              <menu id="tableSelectMenu"
                    label="&tableSelectMenu.label;"
                    accesskey="&tableSelectMenu.accesskey;" >
                <menupopup id="tableSelectPopup">
                  <menuitem id="menu_SelectTable"
                            label="&tableTable.label;"
                            accesskey="&tableTable.accesskey;"
                            observes="cmd_SelectTable"/>
                  <menuitem id="menu_SelectRow"
                            label="&tableRow.label;"
                            accesskey="&tableRow.accesskey;"
                            observes="cmd_SelectRow"/>
                  <menuitem id="menu_SelectColumn"
                            label="&tableColumn.label;"
                            accesskey="&tableColumn.accesskey;"
                            observes="cmd_SelectColumn"/>
                  <menuitem id="menu_SelectCell"
                            label="&tableCell.label;"
                            accesskey="&tableCell.accesskey;"
                            observes="cmd_SelectCell"/>
                  <menuitem id="menu_SelectAllCells"
                            label="&tableAllCells.label;"
                            accesskey="&tableAllCells.accesskey;"
                            observes="cmd_SelectAllCells"/>
                </menupopup>
              </menu>
              <menu id="tableDeleteMenu"
                    label="&tableDeleteMenu.label;"
                    accesskey="&tableDeleteMenu.accesskey;">
                <menupopup id="tableDeletePopup">
                  <menuitem id="menu_DeleteTable"
                            label="&tableTable.label;"
                            accesskey="&tableTable.accesskey;"
                            observes="cmd_DeleteTable"/>
                  <menuitem id="menu_DeleteRow"
                            label="&tableRows.label;"
                            accesskey="&tableRow.accesskey;"
                            observes="cmd_DeleteRow"/>
                  <menuitem id="menu_DeleteColumn"
                            label="&tableColumns.label;"
                            accesskey="&tableColumn.accesskey;"
                            observes="cmd_DeleteColumn"/>
                  <menuitem id="menu_DeleteCell"
                            label="&tableCells.label;"
                            accesskey="&tableCell.accesskey;"
                            observes="cmd_DeleteCell"/>
                  <menuitem id="menu_DeleteCellContents"
                            label="&tableCellContents.label;"
                            accesskey="&tableCellContents.accesskey;"
                            observes="cmd_DeleteCellContents"/>
                </menupopup>
              </menu>
              <menuseparator/>
              <!-- menu label is set in InitTableMenu -->
              <menuitem id="menu_JoinTableCells"
                        label="&tableJoinCells.label;"
                        accesskey="&tableJoinCells.accesskey;"
                        observes="cmd_JoinTableCells"/>
              <menuitem id="menu_SlitTableCell"
                        label="&tableSplitCell.label;"
                        accesskey="&tableSplitCell.accesskey;"
                        observes="cmd_SplitTableCell"/>
              <menuitem id="menu_ConvertToTable"
                        label="&convertToTable.label;"
                        accesskey="&convertToTable.accesskey;"
                        observes="cmd_ConvertToTable"/>
              <menuseparator/>
              <menuitem id="menu_TableOrCellColor"
                        label="&tableOrCellColor.label;"
                        accesskey="&tableOrCellColor.accesskey;"
                        observes="cmd_TableOrCellColor"/>
              <menuitem id="menu_tableProperties"
                        label="&tableProperties.label;"
                        accesskey="&tableProperties.accesskey;"
                        observes="cmd_editTable"/>
            </menupopup>
          </menu>
          <menuseparator/>
          <!-- label and accesskey filled in during menu creation -->
          <menuitem id="objectProperties"
                    command="cmd_objectProperties"/>
          <!-- Don't use 'observes', must call command correctly -->
          <menuitem id="colorsAndBackground"
                    label="&colorsAndBackground.label;"
                    accesskey="&colorsAndBackground.accesskey;"
                    oncommand="goDoCommand('cmd_colorProperties')"
                    observes="cmd_renderedHTMLEnabler"/>
        </menupopup>
      </menu>

      <menu id="optionsMenu" label="&optionsMenu.label;" accesskey="&optionsMenu.accesskey;">
        <menupopup id="optionsMenuPopup" onpopupshowing="setSecuritySettings(1);">
          <menuitem id="menu_checkspelling"
                    label="&checkSpellingCmd2.label;"
                    accesskey="&checkSpellingCmd2.accesskey;"
                    key="key_checkspelling"
                    command="cmd_spelling"
                    class="menuitem-iconic"/>
          <menuitem label="&enableInlineSpellChecker.label;" id="menu_inlineSpellCheck"
                    accesskey="&enableInlineSpellChecker.accesskey;" checked="false"
                    type="checkbox"
                    oncommand="enableInlineSpellCheck(!gSpellChecker.enabled);"/>
          <menuitem label="&quoteCmd.label;"
                    accesskey="&quoteCmd.accesskey;"
                    command="cmd_quoteMessage"/>
          <menuseparator/>
          <menuitem id="returnReceiptMenu" type="checkbox" label="&returnReceiptMenu.label;" accesskey="&returnReceiptMenu.accesskey;" checked="false" oncommand="ToggleReturnReceipt(event.target)"/>
          <menuitem id="dsnMenu" type="checkbox" label="&dsnMenu.label;" accesskey="&dsnMenu.accesskey;" oncommand="ToggleDSN(event.target)"/>
          <menuseparator/>
          <menu id="charsetMenu"
                label="&charsetMenu2.label;"
                accesskey="&charsetMenu2.accesskey;"
                oncommand="SetDocumentCharacterSet(event.target.getAttribute('charset'));"
                onpopupshowing="UpdateCharsetMenu(gMsgCompose.compFields.characterSet, this);">
            <menupopup id="charsetPopup" detectors="false"
                       onpopupshowing="CharsetMenu.build(this, true, this.getAttribute('detectors') != 'false');"/>
          </menu>
          <menu id="outputFormatMenu" label="&deliveryFormatMenu.label;" accesskey="&deliveryFormatMenu.accesskey;" oncommand="OutputFormatMenuSelect(event.target)">
            <menupopup id="outputFormatMenuPopup">
              <menuitem type="radio" name="output_format" label="&autoFormatCmd.label;" accesskey="&autoFormatCmd.accesskey;" id="format_auto"/>
              <menuitem type="radio" name="output_format" label="&plainTextFormatCmd.label;" accesskey="&plainTextFormatCmd.accesskey;" id="format_plain"/>
              <menuitem type="radio" name="output_format" label="&htmlFormatCmd.label;" accesskey="&htmlFormatCmd.accesskey;" id="format_html"/>
              <menuitem type="radio" name="output_format" label="&bothFormatCmd.label;" accesskey="&bothFormatCmd.accesskey;" id="format_both"/>
            </menupopup>
          </menu>
          <menu id="priorityMenu" label="&priorityMenu.label;" accesskey="&priorityMenu.accesskey;" onpopupshowing="updatePriorityMenu();" oncommand="PriorityMenuSelect(event.target);">
            <menupopup id="priorityMenuPopup">
              <menuitem type="radio" name="priority" label="&highestPriorityCmd.label;" accesskey="&highestPriorityCmd.accesskey;" value="Highest" id="priority_highest"/>
              <menuitem type="radio" name="priority" label="&highPriorityCmd.label;" accesskey="&highPriorityCmd.accesskey;" value="High" id="priority_high"/>
              <menuitem type="radio" name="priority" label="&normalPriorityCmd.label;" accesskey="&normalPriorityCmd.accesskey;" value="Normal" id="priority_normal" checked="true"/>
              <menuitem type="radio" name="priority" label="&lowPriorityCmd.label;" accesskey="&lowPriorityCmd.accesskey;" value="Low" id="priority_low"/>
              <menuitem type="radio" name="priority" label="&lowestPriorityCmd.label;" accesskey="&lowestPriorityCmd.accesskey;" value="Lowest"  id="priority_lowest"/>
            </menupopup>
          </menu>
          <menu id="fccMenu" label="&fileCarbonCopyCmd.label;"
                accesskey="&fileCarbonCopyCmd.accesskey;"
                oncommand="MessageFcc(event.target._folder)">
            <menupopup is="folder-menupopup" id="fccMenuPopup" mode="filing"
                       showFileHereLabel="true" fileHereLabel="&fileHereMenu.label;"/>
          </menu>
          <menuseparator/>
          <menuitem type="checkbox" command="cmd_customizeFromAddress"
                    accesskey="&customizeFromAddress.accesskey;"/>
          <menuseparator id="smimeOptionsSeparator"/>

          <menuitem id="menu_securityEncryptRequire1"
                    type="checkbox"
                    label="&menu_securityEncryptRequire.label;"
                    accesskey="&menu_securityEncryptRequire.accesskey;"
                    oncommand="toggleEncryptMessage();"/>
          <menuitem id="menu_securitySign1"
                    type="checkbox"
                    label="&menu_securitySign.label;"
                    accesskey="&menu_securitySign.accesskey;"
                    oncommand="toggleSignMessage();"/>
        </menupopup>
      </menu>

      <menu id="tasksMenu" label="&tasksMenu.label;" accesskey="&tasksMenu.accesskey;">
          <menupopup id="taskPopup">
            <!-- Moving the first two items to the Window menu on the Mac -->
#ifndef XP_MACOSX
            <menuitem id="tasksMenuMail" accesskey="&messengerCmd.accesskey;"
                      label="&messengerCmd.label;" key="key_mail"
                      oncommand="toMessengerWindow();"/>
            <menuitem id="tasksMenuAddressBook"
                      label="&addressBookCmd.label;"
                      accesskey="&addressBookCmd.accesskey;"
                      key="key_addressbook"
                      oncommand="toAddressBook();"
                      class="menuitem-iconic"/>
#endif

#ifndef XP_UNIX
            <menuseparator id="prefSep"/>
            <menuitem label="&accountManagerCmd2.label;"
                      accesskey="&accountManagerCmd2.accesskey;"
                      command="cmd_account"/>
            <menuitem id="menu_preferences"
                      label="&preferencesCmd2.label;"
                      accesskey="&preferencesCmd2.accesskey;"
                      oncommand="openOptionsDialog('paneCompose');"
                      class="menuitem-iconic"/>
#else
#ifdef XP_MACOSX
            <menuitem label="&accountManagerCmd2.label;"
                      accesskey="&accountManagerCmd2.accesskey;"
                      command="cmd_account"/>
            <menuitem id="menu_preferences"
                      label="&preferencesCmd2.label;"
                      accesskey="&preferencesCmd2.accesskey;"
                      oncommand="openOptionsDialog('paneCompose');"/>
#endif
#endif
         </menupopup>
      </menu>

#ifdef XP_MACOSX
#include ../../../base/content/macWindowMenu.inc.xul
#endif

      <!-- Help -->
#include ../../../base/content/helpMenu.inc.xul
    </menubar>
   </toolbaritem>
  </toolbar>

  <toolbarpalette id="MsgComposeToolbarPalette">

    <toolbarbutton class="toolbarbutton-1"
               id="button-send" label="&sendButton.label;"
               tooltiptext="&sendButton.tooltip;"
               command="cmd_sendButton"
               now_label="&sendButton.label;"
               now_tooltiptext="&sendButton.tooltip;"
               later_label="&sendLaterCmd.label;"
               later_tooltiptext="&sendlaterButton.tooltip;">
    </toolbarbutton>

    <toolbarbutton class="toolbarbutton-1"
               id="button-contacts" label="&addressButton.label;"
               tooltiptext="&addressButton.tooltip;"
               autoCheck="false" type="checkbox"
               oncommand="toggleAddressPicker();"/>

    <toolbarbutton class="toolbarbutton-1" type="menu-button"
               id="button-attach" label="&attachButton.label;"
               tooltiptext="&attachButton.tooltip2;"
               command="cmd_attachFile"
               ondragover="nsDragAndDrop.dragOver(event, envelopeDragObserver);"
               ondrop="nsDragAndDrop.drop(event, envelopeDragObserver);"
               ondragexit="nsDragAndDrop.dragExit(event, envelopeDragObserver);">
      <menupopup id="button-attachPopup" onpopupshowing="updateAttachmentItems();">
        <menuitem id="button-attachPopup_attachFileItem"
                  label="&attachFileCmd.label;"
                  accesskey="&attachFileCmd.accesskey;"
                  command="cmd_attachFile"/>
        <menu id="button-attachPopup_attachCloudMenu"
              label="&attachCloudCmd.label;"
              accesskey="&attachCloudCmd.accesskey;"
              command="cmd_attachCloud">
          <menupopup id="attachCloudMenu_popup" onpopupshowing="if (event.target == this) { addAttachCloudMenuItems(this); }"/>
        </menu>
        <menuitem id="button-attachPopup_attachPageItem"
                  label="&attachPageCmd.label;"
                  accesskey="&attachPageCmd.accesskey;"
                  command="cmd_attachPage"/>
        <menuseparator/>
        <menuitem id="button-attachPopup_attachVCardItem"
                  type="checkbox"
                  label="&attachVCardCmd.label;"
                  accesskey="&attachVCardCmd.accesskey;"
                  command="cmd_attachVCard"/>
        <menuseparator id="button-attachPopup_remindLaterSeparator"/>
        <menuitem id="button-attachPopup_remindLaterItem"
                  type="checkbox"
                  label="&remindLater.label;"
                  accesskey="&remindLater.accesskey;"
                  command="cmd_remindLater"/>
      </menupopup>
    </toolbarbutton>

    <toolbarbutton id="button-security"
                   type="menu-button"
                   class="toolbarbutton-1"
                   label="&securityButton.label;"
                   tooltiptext="&securityButton.tooltip;"
                   oncommand="doSecurityButton();">
      <menupopup onpopupshowing="setSecuritySettings(2);">
        <menuitem id="menu_securityEncryptRequire2"
                  type="checkbox"
                  label="&menu_securityEncryptRequire.label;"
                  accesskey="&menu_securityEncryptRequire.accesskey;"
                  oncommand="setNextCommand('encryptMessage');"/>
        <menuitem id="menu_securitySign2"
                  type="checkbox"
                  label="&menu_securitySign.label;"
                  accesskey="&menu_securitySign.accesskey;"
                  oncommand="setNextCommand('signMessage');"/>
        <menuseparator id="smimeToolbarButtonSeparator"/>
        <menuitem id="menu_securityStatus2"
                  label="&menu_securityStatus.label;"
                  accesskey="&menu_securityStatus.accesskey;"
                  oncommand="setNextCommand('show');"/>
      </menupopup>
    </toolbarbutton>

    <toolbarbutton class="toolbarbutton-1" type="menu-button"
               id="spellingButton" label="&spellingButton.label;"
               tooltiptext="&spellingButton.tooltip;"
               command="cmd_spelling">
      <!-- workaround for the bug that split menu doesn't take popup="popupID" -->
      <menupopup onpopupshowing="event.preventDefault();
                                 showPopupById('languageMenuList',
                                               'spellingButton');"/>
    </toolbarbutton>

    <toolbarbutton class="toolbarbutton-1" type="menu-button"
               id="button-save" label="&saveButton.label;"
               tooltiptext="&saveButton.tooltip;"
               command="cmd_saveDefault">
         <menupopup id="button-savePopup" onpopupshowing="InitFileSaveAsMenu();">
           <menuitem id="savePopup_saveAsFile"
                     label="&saveAsFileCmd.label;" accesskey="&saveAsFileCmd.accesskey;"
                     command="cmd_saveAsFile" type="radio" name="radiogroup_SaveAs"/>
           <menuseparator/>
           <menuitem id="savePopup_saveAsDraft"
                     label="&saveAsDraftCmd.label;" accesskey="&saveAsDraftCmd.accesskey;"
                     command="cmd_saveAsDraft" type="radio" name="radiogroup_SaveAs"/>
           <menuitem id="savePopup_saveAsTemplate"
                     label="&saveAsTemplateCmd.label;" accesskey="&saveAsTemplateCmd.accesskey;"
                     command="cmd_saveAsTemplate" type="radio" name="radiogroup_SaveAs"/>
         </menupopup>
    </toolbarbutton>

#ifdef XP_MACOSX
    <toolbarbutton id="button-print"
                   class="toolbarbutton-1"
                   label="&printButton.label;"
                   command="cmd_print"
                   tooltiptext="&printButton.tooltip;"/>
#else
    <toolbarbutton id="button-print"
                   class="toolbarbutton-1"
                   label="&printButton.label;"
                   command="cmd_print"
                   tooltiptext="&printButton.tooltip;"
                   type="menu-button">
      <menupopup id="button-printPopup"
                 onpopupshowing="goUpdateCommand('cmd_printpreview');">
        <menuitem id="button-printMenu"
                  label="&printCmd.label;"
                  accesskey="&printCmd.accesskey;"
                  command="cmd_print"
                  default="true"
                  class="menuitem-iconic"/>
        <menuitem id="button-printPreviewMenu"
                  label="&printPreviewCmd.label;"
                  accesskey="&printPreviewCmd.accesskey;"
                  command="cmd_printPreview"
                  class="menuitem-iconic"/>
      </menupopup>
    </toolbarbutton>
#endif
    <toolbarbutton class="toolbarbutton-1"
               id="quoteButton" label="&quoteButton.label;"
               tooltiptext="&quoteButton.tooltip;"
               command="cmd_quoteMessage"/>

    <toolbarbutton id="cut-button" class="toolbarbutton-1"
                   label="&cutCmd.label;"
                   command="cmd_cut"
                   tooltiptext="&cutButton.tooltip;"/>
    <toolbarbutton id="copy-button" class="toolbarbutton-1"
                   label="&copyCmd.label;"
                   command="cmd_copy"
                   tooltiptext="&copyButton.tooltip;"/>
    <toolbarbutton id="paste-button" class="toolbarbutton-1"
                   label="&pasteCmd.label;"
                   command="cmd_paste"
                   tooltiptext="&pasteButton.tooltip;"/>

    <toolbaritem id="priority-button"
                 align="center"
                 pack="center"
                 title="&priorityButton.title;"
                 tooltiptext="&priorityButton.tooltiptext;">
      <label value="&priorityButton.label;" control="priorityMenu-button"/>
      <menulist id="priorityMenu-button" value="Normal" oncommand="PriorityMenuSelect(event.target);">
        <menupopup id="priorityMenu-buttonPopup">
          <menuitem id="list_priority_highest"
                    name="priority"
                    label="&highestPriorityCmd.label;"
                    value="Highest"/>
          <menuitem id="list_priority_high"
                    name="priority"
                    label="&highPriorityCmd.label;"
                    value="High"/>
          <menuitem id="list_priority_normal"
                    name="priority"
                    label="&normalPriorityCmd.label;"
                    value="Normal"/>
          <menuitem id="list_priority_low"
                    name="priority"
                    label="&lowPriorityCmd.label;"
                    value="Low"/>
          <menuitem id="list_priority_lowest"
                    name="priority"
                    label="&lowestPriorityCmd.label;"
                    value="Lowest"/>
        </menupopup>
      </menulist>
    </toolbaritem>

  </toolbarpalette>
  <toolbar id="composeToolbar2" class="chromeclass-toolbar"
           toolbarname="&showCompositionToolbarCmd.label;"
           accesskey="&showCompositionToolbarCmd.accesskey;"
           fullscreentoolbar="true" mode="full"
#ifdef XP_MACOSX
           iconsize="small"
#endif
           defaultset="button-send,separator,button-address,spellingButton,button-security,button-save,spring,button-attach"
           customizable="true"
           context="toolbar-context-menu">
  </toolbar>

  <toolbarset id="customToolbars" context="toolbar-context-menu"/>
</toolbox>

  <hbox flex="1" id="composeContentBox">
    <vbox id="sidebar-box" persist="sidebarVisible width" hidden="true">
      <sidebarheader id="sidebarHeader" align="center">
        <label id="sidebar-title" value="&addressesSidebarTitle.label;"/>
        <spacer flex="1"/>
        <toolbarbutton id="sidebarCloseButton"
                       class="ab-closebutton close-icon"
                       oncommand="sidebarCloseButtonOnCommand();"/>
      </sidebarheader>
      <browser id="sidebar" flex="1" src="" disablehistory="true"
               style="min-width: 150px; width: 200px; max-width: 400px;"/>
    </vbox>

    <splitter id="sidebar-splitter" hidden="true"/>

    <vbox id="headers-parent" flex="1">
    <toolbox id="headers-box" class="toolbox-top" mode="icons">
    <toolbar id="MsgHeadersToolbar" persist="collapsed" flex="1"
             customizable="true" nowindowdrag="true"
             ondragover="nsDragAndDrop.dragOver(event, envelopeDragObserver);"
             ondrop="nsDragAndDrop.drop(event, envelopeDragObserver);"
             ondragexit="nsDragAndDrop.dragExit(event, envelopeDragObserver);">
      <hbox id="msgheaderstoolbar-box" flex="1">
        <vbox flex="1" id="addresses-box">
          <hbox id="top-gradient-box">
            <hbox class="aw-firstColBox"/>
            <hbox id="identityLabel-box" align="center" pack="end" style="&headersSpace.style;">
              <label id="identityLabel" value="&fromAddr.label;"
                     accesskey="&fromAddr.accesskey;" control="msgIdentity"/>
            </hbox>
            <menulist is="menulist-editable" id="msgIdentity"
                      type="description" flex="1"
                      disableautoselect="true" onkeypress="fromKeyPress(event);"
                      oncommand="LoadIdentity(false);" disableonsend="true">
              <menupopup id="msgIdentityPopup"/>
            </menulist>
          </hbox>
          <richlistbox id="addressingWidget" flex="1" seltype="multiple"
                       onclick="awClickEmptySpace(event.originalTarget, true)"
                       disableonsend="true">
            <treecols hidden="true">
              <treecol id="firstcol-addressingWidget"/>
              <treecol id="typecol-addressingWidget" style="&headersSpace.style;"/>
              <treecol id="textcol-addressingWidget" flex="1"/>
            </treecols>
            <richlistitem class="addressingWidgetItem" allowevents="true">
              <hbox class="aw-firstColBox" align="center">
                <image class="deleteAddress close-icon"
                       onclick="awDeleteAddressOnClick(this);"/>
              </hbox>
              <hbox class="addressingWidgetCell" align="center" style="&headersSpace.style;">
                <menulist id="addressCol1#1" disableonsend="true"
                          class="aw-menulist" flex="1"
                          oncommand="onAddressColCommand(this.id);">
                  <menupopup>
                    <menuitem value="addr_to" label="&toAddr.label;"/>
                    <menuitem value="addr_cc" label="&ccAddr.label;"/>
                    <menuitem value="addr_bcc" label="&bccAddr.label;"/>
                    <menuitem value="addr_reply" label="&replyAddr.label;"/>
                    <menuitem value="addr_newsgroups" label="&newsgroupsAddr.label;"/>
                    <menuitem value="addr_followup" label="&followupAddr.label;"/>
                  </menupopup>
                </menulist>
              </hbox>
              <hbox class="addressingWidgetCell" flex="1">
                <textbox id="addressCol2#1" class="plain textbox-addressingWidget uri-element"
                         aria-labelledby="addressCol1#1"
                         type="autocomplete" flex="1"
                         autocompletesearch="mydomain addrbook ldap news"
                         autocompletesearchparam="{}"
                         timeout="300"
                         maxrows="6"
                         completedefaultindex="true" forcecomplete="true"
                         completeselectedindex="true"
                         minresultsforpopup="2" ignoreblurwhilesearching="true"
                         onfocus="awRecipientOnFocus(this);"
                         ontextentered="awRecipientTextCommand(param, this)"
                         onchange="onRecipientsChanged();"
                         oninput="onRecipientsChanged();"
                         onkeypress="awRecipientKeyPress(event, this)"
                         onkeydown="awRecipientKeyDown(event, this)"
                         disableonsend="true">
                </textbox>
              </hbox>
            </richlistitem>
          </richlistbox>
          <hbox id="subject-box">
            <hbox class="aw-firstColBox"/>
            <hbox align="center" pack="end" style="&headersSpace.style;">
              <label id="subjectLabel" value="&subject.label;" accesskey="&subject.accesskey;" control="msgSubject"/>
            </hbox>
            <textbox id="msgSubject" flex="1" class="toolbar" disableonsend="true" spellcheck="true"
                     oninput="gContentChanged = true; SetComposeWindowTitle();"
                     onkeypress="subjectKeyPress(event);" />
          </hbox>
        </vbox>
        <splitter id="attachmentbucket-sizer"
                  collapsed="true"
                  collapse="after"
                  onmouseup="attachmentBucketSizerOnMouseUp();"/>
        <vbox id="attachments-box" collapsed="true" persist="width">
          <hbox id="attachments-header-box"
                align="stretch"
                tooltiptext="&attachmentBucketCloseButton.tooltip;"
                onclick="attachmentBucketHeaderOnClick(event);"
                context="attachmentHeaderContext">
            <hbox id="attachmentBucketCountBox"
                  align="center"
                  context="msgComposeAttachmentListContext">
              <label id="attachmentBucketCount"
                     accesskey="&attachments.accesskey;"
                     control="attachmentBucket"
                     flex="1" crop="end"/>
            </hbox>
            <toolbarspring/>
            <hbox id="attachmentBucketSizeBox"
                  align="center"
                  context="msgComposeAttachmentListContext">
              <label id="attachmentBucketSize"/>
            </hbox>
            <toolbarbutton id="attachmentBucketCloseButton"
                           class="ab-closebutton close-icon"
                           tooltiptext="&attachmentBucketCloseButton.tooltip;"
                           context=""
                           oncommand="attachmentBucketCloseButtonOnCommand();"/>
          </hbox>
          <richlistbox is="attachment-list" id="attachmentBucket"
                       class="attachmentList"
                       orient="vertical"
                       tooltiptext=""
                       disableonsend="true"
                       seltype="multiple"
                       flex="1"
                       height="0"
                       role="listbox"
                       context="msgComposeAttachmentListContext"
                       itemcontext="msgComposeAttachmentItemContext"
                       onclick="attachmentBucketOnClick(event);"
                       onkeypress="attachmentBucketOnKeyPress(event);"
                       onselect="attachmentBucketOnSelect();"
                       ondragstart="attachmentBucketOnDragStart(event);"
                       onblur="attachmentBucketOnBlur();"/>
        </vbox>
        <vbox id="attachments-placeholder-box"
              hidden="true"
              tooltiptext=""
              onclick="goDoCommand('cmd_toggleAttachmentPane')"/>
      </hbox>
    </toolbar>

    <toolbox id="FormatToolbox" mode="icons">
      <toolbar class="chromeclass-toolbar" id="FormatToolbar" persist="collapsed"
               customizable="true" nowindowdrag="true">
#include editFormatButtons.inc.xul
        <spacer flex="1"/>
      </toolbar>
    </toolbox>
  </toolbox>

  <splitter id="compose-toolbar-sizer" onmousedown="awSizerListen()" orient="vertical"/>

  <!-- The mail message body frame -->
  <vbox id="appcontent" flex="1">
    <editor id="content-frame"
            type="content"
            primary="true"
            src="about:blank"
            name="browser.message.body"
            aria-label="&aria.message.bodyName;"
            minheight="100"
            flex="1"
            ondblclick="EditorDblClick(event);"
            context="msgComposeContext"/>
    <findbar id="FindToolbar" browserid="content-frame"/>
  </vbox>

  </vbox>
  </hbox>
  <panel id="customizeToolbarSheetPopup" noautohide="true">
    <iframe id="customizeToolbarSheetIFrame"
            style="&dialog.dimensions;"
            hidden="true"/>
  </panel>

  <hbox id="compose-notification-bottom">
    <!-- notificationbox will be added here lazily. -->
  </hbox>

  <hbox id="status-bar" class="statusbar chromeclass-status">
    <statusbarpanel id="statusText" flex="1"/>
    <hbox id="statusbar-progresspanel"
          class="statusbarpanel statusbarpanel-progress"
          collapsed="true">
      <html:progress id="compose-progressmeter" class="progressmeter-statusbar" value="0" max="100"/>
    </hbox>
    <hbox id="signing-status"
          class="statusbarpanel statusbarpanel-iconic"
          collapsed="true"
          oncommand="showMessageComposeSecurityStatus();">
      <image/>
    </hbox>
    <hbox id="encryption-status"
          class="statusbarpanel statusbarpanel-iconic"
          collapsed="true"
          oncommand="showMessageComposeSecurityStatus();">
      <image/>
    </hbox>
    <statusbarpanel id="encodingStatusPanel" tooltiptext="&encodingStatusPanel.tooltip;"/>
    <hbox id="spellCheckStatusPanel" class="statusbarpanel">
      <toolbarbutton id="languageStatusButton"
                     tooltiptext="&languageStatusButton.tooltip;"
                     oncommand="showPopupById('languageMenuList',
                                              'languageStatusButton',
                                              'before_start');">
      </toolbarbutton>
    </hbox>
  </hbox>
</window>
